(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require=="function"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require=="function"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(require,module,exports){
function showTitles(){clearTimeout(titleHideTimeout),$("#title").removeClass("transform-transition").addClass("hide").addClass("transform-transition").show(),setTimeout(function(){$("#title").removeClass("hide")},1),$(".score").css("opacity",0)}function hideTitles(){$(".score").css("opacity",1),$("#title:visible").length>0&&($("#title").addClass("transform-transition").addClass("hide"),titleHideTimeout=setTimeout(function(){$("#title").hide()},1e3))}var Poem=null,levels=null,EventDispatcher=require("./utils/EventDispatcher"),currentLevel=null,currentPoem=null,titleHideTimeout=null,levelLoader={init:function(e,t){Poem=e,levels=t},load:function(e){return!!_.isObject(levels[e])&&(currentPoem&&currentPoem.destroy(),currentLevel=levels[e],currentPoem=new Poem(currentLevel,e),"titles"===e?showTitles():hideTitles(),this.dispatch({type:"newLevel",level:currentLevel,poem:currentPoem}),window.poem=currentPoem,!0)}};EventDispatcher.prototype.apply(levelLoader),module.exports=levelLoader;

},{"./utils/EventDispatcher":40}],2:[function(require,module,exports){
function createFog(e,t){var i=_.extend({color:2236962,nearFactor:.5,farFactor:2},e);return new THREE.Fog(i.color,t*i.nearFactor,t*i.farFactor)}var Coordinates=require("./utils/Coordinates"),Camera=require("./components/Camera"),Gun=require("./managers/Gun"),Ship=require("./Ship"),Stars=require("./components/Stars"),AsteroidField=require("./managers/AsteroidField"),Stats=require("./utils/Stats"),EventDispatcher=require("./utils/EventDispatcher"),JellyShip=require("./entities/JellyShip"),EntityManager=require("./managers/EntityManager"),ScoringAndWinning=require("./components/ScoringAndWinning"),Clock=require("./utils/Clock"),renderer,Poem=function(e,t){this.circumference=e.config.circumference||750,this.height=e.config.height||120,this.r=e.config.r||240,this.circumferenceRatio=2*Math.PI/this.circumference,this.ratio=window.devicePixelRatio>=1?window.devicePixelRatio:1,this.slug=t,this.controls=void 0,this.div=document.getElementById("container"),this.scene=new THREE.Scene,this.requestedFrame=void 0,this.started=!1,this.clock=new Clock,this.coordinates=new Coordinates(this),this.camera=new Camera(this,e.config.camera||{}),this.scene.fog=createFog(e.config.fog,this.camera.object.position.z),this.gun=new Gun(this),this.ship=new Ship(this),this.stars=new Stars(this,e.config.stars),this.scoringAndWinning=new ScoringAndWinning(this,e.config.scoringAndWinning),this.parseLevel(e),this.dispatch({type:"levelParsed"}),renderer||this.addRenderer(),this.addEventListeners(),this.start()};module.exports=Poem,Poem.prototype={parseLevel:function(e){_.each(e.objects,function(e,t){_.isObject(e)?this[t]=new e.object(this,e.properties):this[t]=e},this)},addRenderer:function(){renderer=new THREE.WebGLRenderer({alpha:!0}),renderer.setSize(window.innerWidth,window.innerHeight),this.div.appendChild(renderer.domElement)},getCanvas:function(){if(renderer)return renderer.domElement},addStats:function(){this.stats=new Stats,this.stats.domElement.style.position="absolute",this.stats.domElement.style.top="0px",$("#container").append(this.stats.domElement)},addEventListeners:function(){$(window).on("resize",this.resizeHandler.bind(this))},resizeHandler:function(){this.camera.resize(),renderer.setSize(window.innerWidth,window.innerHeight)},start:function(){this.started||this.loop(),this.started=!0},loop:function(){this.requestedFrame=requestAnimationFrame(this.loop.bind(this)),this.update()},pause:function(){window.cancelAnimationFrame(this.requestedFrame),this.started=!1},update:function(){this.dispatch({type:"update",dt:this.clock.getDelta(),time:this.clock.time}),renderer.render(this.scene,this.camera.object)},destroy:function(){window.cancelAnimationFrame(this.requestedFrame),this.dispatch({type:"destroy"})}},EventDispatcher.prototype.apply(Poem.prototype);

},{"./Ship":3,"./components/Camera":4,"./components/ScoringAndWinning":10,"./components/Stars":11,"./entities/JellyShip":19,"./managers/AsteroidField":26,"./managers/EntityManager":27,"./managers/Gun":28,"./utils/Clock":37,"./utils/Coordinates":39,"./utils/EventDispatcher":40,"./utils/Stats":41}],3:[function(require,module,exports){
var HID=require("./components/Hid"),Damage=require("./components/Damage"),destroyMesh=require("./utils/destroyMesh"),Ship=function(t){this.poem=t,this.scene=t.scene,this.polarObj=new THREE.Object3D,this.object=null,this.hid=new HID(this.poem),this.color=4890087,this.linewidth=2*this.poem.ratio,this.radius=3,this.position=new THREE.Vector2,this.dead=!1,this.killTimeout=null,this.lives=3,this.invulnerable=!0,this.invulnerableLength=3e3,this.invulnerableTime=0+this.invulnerableLength,this.invulnerableflipFlop=!1,this.invulnerableflipFlopLength=100,this.invulnerableflipFlopTime=0,this.speed=0,this.edgeAvoidanceBankSpeed=.04,this.edgeAvoidanceThrustSpeed=.001,this.thrustSpeed=.001,this.thrust=0,this.bankSpeed=.06,this.bankSpeed=.0075,this.bank=0,this.maxSpeed=500,this.addObject(),this.damage=new Damage(this.poem,{color:this.color}),this.poem.on("update",this.update.bind(this))};module.exports=Ship,Ship.prototype={createGeometry:function(){var t,i,e,s;return t=new THREE.Geometry,i=[[50,36.9],[39.8,59.6],[47.1,53.9],[50,57.5],[53,53.9],[60.2,59.6],[50,36.9]],e=_.reduce(i,function(t,i){return[t[0]+i[0],t[1]+i[1]]},[0,0]),s=[e[0]/i.length,e[1]/i.length],t.vertices=_.map(i,function(t){var i=.25;return new THREE.Vector3((t[1]-s[1])*i*-1,(t[0]-s[0])*i,0)}),t},addObject:function(){var t,i;t=this.createGeometry(),i=new THREE.LineBasicMaterial({color:this.color,linewidth:this.linewidth}),this.object=new THREE.Line(t,i,THREE.LineStrip),this.object.position.z+=this.poem.r,this.polarObj.add(this.object),this.reset(),this.scene.add(this.polarObj),this.poem.on("destroy",destroyMesh(this.object))},disable:function(){clearTimeout(this.killTimeout),this.dead=!0,this.object.visible=!1},kill:function(t){if(!t&&!this.dead&&!this.invulnerable){this.dead=!0,this.object.visible=!1,this.damage.explode(this.position);var i=Math.ceil(this.poem.scoringAndWinning.score/-2);this.poem.scoringAndWinning.adjustScore(i,i+" points",{"font-size":"2em",color:"red"}),this.killTimeout=setTimeout(function(){this.dead=!1,this.invulnerable=!0,this.invulnerableTime=this.poem.clock.time+this.invulnerableLength,this.object.visible=!0,this.reset()}.bind(this),2e3)}},reset:function(){this.position.x=0,this.position.y=0,this.speed=.2,this.bank=0},update:function(t){this.dead||(this.updateThrustAndBank(t),this.updateEdgeAvoidance(t),this.updatePosition(t),this.updateFiring(t),this.updateInvulnerability(t)),this.damage.update(t),this.hid.update(t)},updateInvulnerability:function(t){this.invulnerable&&(t.time<this.invulnerableTime?t.time>this.invulnerableflipFlopTime&&(this.invulnerableflipFlopTime=t.time+this.invulnerableflipFlopLength,this.invulnerableflipFlop=!this.invulnerableflipFlop,this.object.visible=this.invulnerableflipFlop):(this.object.visible=!0,this.invulnerable=!1))},updateThrustAndBank:function(t){var i,e,s,h;if(this.bank*=.9,this.thrust=0,"keys"===this.hid.type())i=this.hid.pressed,i.up&&(this.thrust+=this.thrustSpeed*t.dt),i.down&&(this.thrust-=this.thrustSpeed*t.dt),i.left&&(this.bank+=this.bankSpeed),i.right&&(this.bank+=this.bankSpeed*-1);else{e=this.hid.tilt;var n=Math.sqrt(e.x*e.x+e.y*e.y);this.thrust=Math.min(.0011,n/1e4),this.thrust*=t.dt,s=Math.atan2(e.y,e.x),h=(s-this.object.rotation.z)%(2*Math.PI),h>Math.PI?h-=2*Math.PI:h<-Math.PI&&(h+=2*Math.PI),this.bank=h*n/2500*t.dt}},updateEdgeAvoidance:function(t){var i,e,s,h,n,o;e=this.poem.height/2,i=.8*e,s=this.object.position.y,o=Math.abs(s);this.object.rotation.z/Math.PI;if(this.object.rotation.z%=2*Math.PI,this.object.rotation.z<0&&(this.object.rotation.z+=2*Math.PI),Math.abs(s)>i){var a=this.object.rotation.z>=.5*Math.PI&&this.object.rotation.z<1.5*Math.PI;n=s>0?a?1:-1:a?-1:1,h=(o-i)/(e-i),this.thrust+=h*this.edgeAvoidanceThrustSpeed,this.object.rotation.z+=n*h*this.edgeAvoidanceBankSpeed}},updateFiring:function(t){this.hid.pressed.spacebar&&this.poem.gun.fire(this.position.x,this.position.y,2,this.object.rotation.z)},updatePosition:function(){new THREE.Vector3;return function(t){var i;this.object.rotation.z+=this.bank,i=this.object.rotation.z,this.speed*=.98,this.speed+=this.thrust,this.speed=Math.min(this.maxSpeed,this.speed),this.speed=Math.max(0,this.speed),this.position.x+=this.speed*Math.cos(i),this.position.y+=this.speed*Math.sin(i),this.object.position.y=this.position.y,this.polarObj.rotation.y=this.position.x*this.poem.circumferenceRatio}}(),destroy:function(){this.object.geometry.dispose(),this.object.material.dispose()}};

},{"./components/Damage":7,"./components/Hid":8,"./utils/destroyMesh":43}],4:[function(require,module,exports){
var Camera=function(t,e){this.poem=t,this.polarObj=new THREE.Object3D,this.speed=.032,this.object=new THREE.PerspectiveCamera(50,window.innerWidth/window.innerHeight,e.nearFrustum?e.nearFrustum:3,e.farFrustum?e.farFrustum:1e3);var i=e.multiplier?e.multiplier:1.5;this.object.position.z=this.poem.r*i,this.polarObj.add(this.object),this.poem.scene.add(this.polarObj),this.poem.on("update",this.update.bind(this))};module.exports=Camera,Camera.prototype={resize:function(){this.object.aspect=window.innerWidth/window.innerHeight,this.object.updateProjectionMatrix()},update:function(t){var e=this.polarObj.rotation.y,i=this.poem.ship.polarObj.rotation.y;Math.abs(e-i);this.polarObj.rotation.y=i*this.speed+e*(1-this.speed)}};

},{}],5:[function(require,module,exports){
var CameraIntro=function(t,e){this.poem=t;var i=e.heightMultiplier?e.heightMultiplier:5;this.poem.camera.object.position.y=this.poem.height*i,this.origin=e.origin?e.origin:new THREE.Vector3,this.speed=e.speed?e.speed:.98,this.boundUpdate=this.update.bind(this),this.poem.on("update",this.boundUpdate)};CameraIntro.prototype={update:function(t){this.poem.camera.object.position.y*=this.speed,this.poem.camera.object.lookAt(this.origin),this.poem.camera.object.position.y<.1&&this.poem.off("update",this.boundUpdate)}},module.exports=CameraIntro;

},{}],6:[function(require,module,exports){
function _generateCylinderVertices(e,t,r,n,i){for(var s,o,a,c,u,h,d,l,m,g=1-i,f=1+i,_=twoπ/t,E=0,p=0;p<=t;p++)s=cos(_*p)*r*random.range(g,f),o=sin(_*p)*r*random.range(g,f),u=n*random.range(g,f)+E,p>0?(p===t&&(s=d,o=l,u=m),e.push(new THREE.Vector3(s,.5*u,o)),e.push(new THREE.Vector3(s,u*-.5,o)),e.push(new THREE.Vector3(s,.5*u,o)),e.push(new THREE.Vector3(a,.5*h,c)),e.push(new THREE.Vector3(s,u*-.5,o)),e.push(new THREE.Vector3(a,h*-.5,c))):(d=s,l=o,m=u),a=s,c=o,h=u;return e}function _generateMultipleCylinderVertices(e,t,r,n,i,s){for(var o,a,c=0;c<e;c++)o=c/e,a=1-o,_generateCylinderVertices(t,Math.floor((r-3)*a)+3,n*a,i*a*a,s)}function _getThetasOnXZPlane(e){return _.map(e,function(e){return Math.atan2(e.z,e.x)})}function _getYs(e){return _.map(e,function(e){return e.y})}function _getUnitIntervalOfDistanceFromYOrigin(e){var t=_.map(e,function(e){return Math.sqrt(e.x*e.x+e.z*e.z)}),r=_.reduce(t,function(e,t){return Math.max(e,t)},0);if(0===r)throw new Error("maxDistance can't be 0");return _.map(t,function(e){return e/r})}function _verticesWaver(e,t){var r=_getThetasOnXZPlane(e),n=_getYs(e),i=_getUnitIntervalOfDistanceFromYOrigin(e);return function(s){for(var o,a,c=.0015*s.time,u=twoπ,h=0,d=e.length;h<d;h++)o=t*i[h],a=3*r[h]+c+u*i[h],e[h].y=Math.sin(a)*o+n[h]}}var twoπ=2*Math.PI,cos=Math.cos,sin=Math.sin,random=require("../utils/random.js"),destroyMesh=require("../utils/destroyMesh"),CylinderLines=function(e,t){this.poem=e;var r=.5,n=.5,i=.5,s=new THREE.Geometry,o=(e.r*(_.isNumber(t.heightPercentage)?t.radiusPercentage:.8),e.r*(_.isNumber(t.radiusPercentage)?t.radiusPercentage:.8)),a=_.isNumber(t.sides)?t.sides:15,c=_.isNumber(t.eccentricity)?t.eccentricity:.1,u=_.isNumber(t.iterations)?t.iterations:10;_generateMultipleCylinderVertices(u,s.vertices,a,o,e.height,c);var h=_verticesWaver(s.vertices,.1*e.height),d=new THREE.LineBasicMaterial({color:this.color,linewidth:this.linewidth,fog:!0});this.object=new THREE.Line(s,d,THREE.LinePieces),this.poem.scene.add(this.object),this.poem.on("destroy",destroyMesh(this.object)),this.poem.on("update",function(e){r=(r+2e-4*e.dt)%1,d.color.setHSL(r,i,n),h(e),s.verticesNeedUpdate=!0}.bind(this))};module.exports=CylinderLines;

},{"../utils/destroyMesh":43,"../utils/random.js":44}],7:[function(require,module,exports){
var _=require("underscore"),random=require("../utils/random.js"),Bullet=require("../entities/Bullet"),SoundGenerator=require("../sound/SoundGenerator"),destroyMesh=require("../utils/destroyMesh"),Damage=function(e,t){this.poem=e,this.color=null,this.perExplosion=100,this.retainExplosionsCount=3,this.bullets=[],this.explodeSpeed=3,this.transparent=!1,this.opacity=1,this.explosionCount=0,this.explosionSound=null,_.isObject(t)&&_.extend(this,t),this.count=this.perExplosion*this.retainExplosionsCount,this.addObject(),this.addSound()};Damage.prototype={generateGeometry:function(){for(var e,t,o=new THREE.Geometry,s=0;s<this.count;s++)e=new THREE.Vector3,t=new Bullet(this.poem,this,e),o.vertices.push(e),this.bullets.push(t),t.kill(),t.position.y=1e3;return o},addObject:function(){var e;e=this.generateGeometry(),this.object=new THREE.PointCloud(e,new THREE.PointCloudMaterial({size:1*this.poem.ratio,color:this.color,transparent:this.transparent,opacity:this.opacity})),this.object.frustumCulled=!1,this.poem.scene.add(this.object),this.poem.on("destroy",destroyMesh(this.object))},addSound:function(){var e=this.explosionSound=new SoundGenerator;e.connectNodes([e.makeOscillator("sawtooth"),e.makeGain(),e.getDestination()]),e.setGain(0,0,0),e.start(),this.poem.on("destroy",function(){e.destroy()})},reset:function(){_.each(this.bullets,function(e){e.kill()})},explode:function(e){this.playExplosionSound(),_.each(_.sample(this.bullets,this.perExplosion),function(t){var o=random.range(0,2*Math.PI),s=random.rangeLow(0,this.explodeSpeed);t.alive=!0,t.position.copy(e),t.speed.x=s*Math.cos(o),t.speed.y=s*Math.sin(o)}.bind(this))},playExplosionSound:function(){var e=450,t=this.explosionSound;t.setGain(.5,0,.001),t.setFrequency(e,0,0);var o=.02,s=6,i=1;for(i=1;i<s;i++)t.setFrequency(e*Math.random(),o*i,o);setTimeout(function(){t.setGain(0,o*s,.2),t.setFrequency(.11*e,o*s,.05)},50)},update:function(e){_.each(this.bullets,function(t){t.update(e),t.speed.multiplyScalar(.999)}),this.object.geometry.verticesNeedUpdate=!0}},module.exports=Damage;

},{"../entities/Bullet":18,"../sound/SoundGenerator":31,"../utils/destroyMesh":43,"../utils/random.js":44,"underscore":75}],8:[function(require,module,exports){
var EventDispatcher=require("../utils/EventDispatcher");window.HIDtype="keys";var HID=function(t){this.poem=t;var e={up:!1,down:!1,left:!1,right:!1,spacebar:!1};this.keyCodes={k38:"up",k40:"down",k37:"left",k39:"right",k32:"spacebar"},this.tilt={x:0,y:0},this.pressed=_.clone(e),this.down=_.clone(e),this.up=_.clone(e),"keys"===window.HIDtype?this.setKeyHandlers():this.setTiltHandlers()};HID.prototype={setKeyHandlers:function(){$(window).on("keydown.HID",this.keydown.bind(this)),$(window).on("keyup.HID",this.keyup.bind(this)),this.poem.on("destroy",function(){$(window).off("keydown.HID"),$(window).off("keyup.HID")})},setTiltHandlers:function(){$(window).on("deviceorientation.HID",this.handleTilt.bind(this)),$("canvas").on("touchstart.HID",this.handleTouchStart.bind(this)),$("canvas").on("touchend.HID",this.handleTouchEnd.bind(this)),this.poem.on("destroy",function(){$(window).off("deviceorientation.HID"),$("canvas").off("touchstart.HID"),$("canvas").off("touchend.HID")})},type:function(){return window.HIDtype},setKeys:function(){window.HIDtype="keys"},setTilt:function(){window.HIDtype="tilt"},keydown:function(t){var e=this.keyCodes["k"+t.keyCode];e&&(this.down[e]=!0,this.pressed[e]=!0)},keyup:function(t){var e=this.keyCodes["k"+t.keyCode];e&&(this.pressed[e]=!1,this.up[e]=!0)},handleTilt:function(t){var e,n,i;e=t.originalEvent,n=window.orientation||screen.orientation,i=_.isObject(screen.orientation)?screen.orientation.angle:_.isNumber(window.orientation)?window.orientation:0,0===i?this.tilt={x:e.gamma,y:e.beta*-1}:i>0?this.tilt={x:e.beta,y:e.gamma}:this.tilt={x:e.beta*-1,y:e.gamma*-1}},handleTouchStart:function(t){t.preventDefault(),this.pressed.spacebar=!0},handleTouchEnd:function(t){var e=t.originalEvent.touches;this.pressed.spacebar=0!==e.length},update:function(){var t=function(t,e,n){n[e]=!1};return function(){_.each(this.down,t),_.each(this.up,t)}}()},EventDispatcher.prototype.apply(HID.prototype),module.exports=HID;

},{"../utils/EventDispatcher":40}],9:[function(require,module,exports){
function generateCylinder(e,r,t,n,i){for(var a=2*Math.PI/r,c=6*a,s=0;s<=r;s++)e.push(new THREE.Vector3(Math.cos(a*s)*t,i*Math.sin(c*s)+n,Math.sin(a*s)*t)),e.push(new THREE.Vector3(Math.cos(a*(s+1))*t,i*Math.sin(c*(s+1))+n,Math.sin(a*(s+1))*t));return e}function createGeometry(e,r){var t=new THREE.Geometry,n=r/20;return generateCylinder(t.vertices,64,e,r*-.775,n),generateCylinder(t.vertices,64,e,.775*r,n),generateCylinder(t.vertices,64,e,r*-.75,n),generateCylinder(t.vertices,64,e,.75*r,n),generateCylinder(t.vertices,64,e,r*-.7,n),generateCylinder(t.vertices,64,e,.7*r,n),generateCylinder(t.vertices,64,e,r*-.6,n),generateCylinder(t.vertices,64,e,.6*r,n),t}function createMaterial(e,r){return new THREE.LineBasicMaterial({color:e,linewidth:2*r})}function createAndAddObject(e,r,t){var n=new THREE.Line(e,r,THREE.LinePieces);return t.add(n),n}var Rails=function(e,r){createAndAddObject(createGeometry(e.r,e.height),createMaterial(4478293,e.ratio),e.scene)};module.exports=Rails;

},{}],10:[function(require,module,exports){
var routing=require("../routing"),scores=require("./scores"),selectors=require("../utils/selectors"),levels=require("../levels"),ScoringAndWinning=function(e,s){s=_.isObject(s)?s:{},this.poem=e,this.$score=selectors("#score",{value:".score-value",total:".score-total",bar:".score-bar-bar",text:".score-bar-number",enemiesCount:".enemies-count",message:".score-message"}),this.$win=selectors("#win",{score:".win-score",maxScore:".win-max-score",text:".win-text",nextLevel:".win-next-level",restart:".win-restart"}),this.score=0,this.enemiesCount=0,this.scoreMessageId=0,this.message=_.isString(s.message)?s.message:"You Win",this.nextLevel=s.nextLevel?s.nextLevel:null,this.won=!1,this.maxScore=levels[e.slug].maxScore,this.$score.total.text(this.maxScore),this.updateScoreElements(),this.conditionsRemaining=[],this.poem.on("levelParsed",function(){this.setConditions(s.conditions)}.bind(this))};module.exports=ScoringAndWinning,ScoringAndWinning.prototype={setConditions:function(e){_.each(e,function(e){var s=this.poem[e.component],i=_.union(this,e.properties);s.watchForCompletion.apply(s,i),this.conditionsRemaining.push(s)}.bind(this))},reportConditionCompleted:function(e){this.won||_.defer(function(){this.conditionsRemaining=_.filter(this.conditionsRemaing,function(s){return s!==e}),0===this.conditionsRemaining.length&&(this.poem.ship.disable(),this.won=!0,this.conditionsCompleted())}.bind(this))},reportConditionIncomplete:function(e){this.won||_.defer(function(){var s=this.conditionsRemaining.indexOf(e);s===-1&&this.conditionsRemaining.push(e)}.bind(this))},adjustEnemies:function(e){return this.enemiesCount+=e,this.$score.enemiesCount.text(this.enemiesCount),this.enemiesCount},adjustScore:function(e,s,i){if(!this.won)return this.score+=e,this.updateScoreElements(),s&&this.showMessage(s,i),this.score},updateScoreElements:function(){var e=Math.round(this.score/this.maxScore*100);this.$score.value.text(this.score),this.$score.bar.width(),this.$score.text.toggleClass("score-bar-left",e>=50),this.$score.text.toggleClass("score-bar-right",e<50),this.$score.bar.css({width:e+"%",backgroundColor:"#f00"}),this.updateScoreElementsTimeout=setTimeout(function(){this.$score.bar.css({width:e+"%",backgroundColor:"#C44F4F"})}.bind(this),500)},showMessage:function(e,s){var i=$("<span></span>").text(e);s&&i.css(s),this.$score.message.hide(),this.$score.message.empty().append(i),this.$score.message.removeClass("fadeout"),this.$score.message.addClass("fadein"),this.$score.message.show(),this.$score.message.removeClass("fadein");var t=++this.scoreMessageId;setTimeout(function(){t===this.scoreMessageId&&this.$score.message.addClass("fadeout")}.bind(this),2e3)},conditionsCompleted:function(){this.$win.score.text(this.score),this.$win.maxScore.text(this.maxScore),this.$win.text.html(this.message),this.showWinScreen(),this.$win.nextLevel.off().one("click",function(e){e.preventDefault(),routing.loadUpALevel(this.nextLevel),this.hideWinScreen()}.bind(this)),this.$win.restart.off().one("click",function(e){e.preventDefault(),routing.loadUpALevel(this.poem.slug),this.hideWinScreen()}.bind(this))},showWinScreen:function(){this.$win.scope.removeClass("transform-transition").addClass("hide").addClass("transform-transition").show(),$("#container canvas").css("opacity",.3),scores.set(this.poem.slug,this.score),setTimeout(function(){this.$win.scope.removeClass("hide")}.bind(this),1),this.poem.on("destroy",this.hideWinScreen.bind(this))},hideWinScreen:function(){this.$win.scope.addClass("hide"),$("#container canvas").css("opacity",1),setTimeout(function(){this.$win.scope.hide()}.bind(this),1e3)}};

},{"../levels":22,"../routing":29,"../utils/selectors":45,"./scores":15}],11:[function(require,module,exports){
var destroyMesh=require("../utils/destroyMesh"),Stars=function(t,e){e=_.isObject(e)?e:{},this.poem=t,this.object=null,this.count=_.isNumber(e.count)?e.count:4e4,this.depth=7.5,this.color=11184810,this.addObject()};module.exports=Stars,Stars.prototype={generateGeometry:function(){var t,e,o,s,r,h;h=new THREE.Geometry;for(var i=0;i<this.count;i++)t=Math.random()*this.depth*this.poem.r,t<this.poem.r&&(t=Math.random()*this.depth*this.poem.r),e=2*Math.random()*Math.PI,o=Math.cos(e)*t,r=Math.sin(e)*t,s=(.5-Math.random())*this.depth*this.poem.r,h.vertices.push(new THREE.Vector3(o,s,r));return h},addObject:function(){var t;t=this.generateGeometry(),this.object=new THREE.PointCloud(t,new THREE.PointCloudMaterial({size:.5*this.poem.ratio,color:this.color,fog:!1})),this.poem.scene.add(this.object),this.poem.on("destroy",destroyMesh(this.object))}};

},{"../utils/destroyMesh":43}],12:[function(require,module,exports){
var HID=require("../Components/Hid"),routing=require("../routing"),Titles=function(e,t){this.poem=e,this.poem.ship.disable(),this.rotateStars(),$("a[href=#keys]").off().click(this.handleKeysClick.bind(this)),$("a[href=#tilt]").off().click(this.handleTiltClick.bind(this)),this.webglCheck()};module.exports=Titles,Titles.prototype={webglEnabled:function(){try{var e=document.createElement("canvas");return!!window.WebGLRenderingContext&&(e.getContext("webgl")||e.getContext("experimental-webgl"))}catch(e){return!1}}(),webglCheck:function(){this.webglEnabled||($("a[href=#keys]").hide(),$("a[href=#tilt]").hide(),$(".title-webgl-error").show())},handleKeysClick:function(e){e.preventDefault(),HID.prototype.setKeys(),this.nextLevel()},handleTiltClick:function(e){e.preventDefault(),HID.prototype.setTilt(),this.nextLevel()},nextLevel:function(){routing.loadUpALevel("intro")},rotateStars:function(){this.poem.on("update",function(e){this.poem.stars.object.rotation.y-=1e-4*e.dt}.bind(this))}};

},{"../Components/Hid":8,"../routing":29}],13:[function(require,module,exports){
var twoπ=2*Math.PI;module.exports=function(e,t,o,r){for(var s,a,c,h,n,E,u,w,M,p=new THREE.Geometry,i=p.vertices,m=p.faces,H=twoπ/e,R=r/t,T=0,V=0;V<t;V++){T+=.5;for(var f=0;f<e;f++)M=f+T,s=new THREE.Vector3(Math.cos(H*M)*o,V*R-r/2,Math.sin(H*M)*o),a=new THREE.Vector3(Math.cos(H*(M+1))*o,V*R-r/2,Math.sin(H*(M+1))*o),c=new THREE.Vector3(Math.cos(H*(M+.5))*o,(V+1)*R-r/2,Math.sin(H*(M+.5))*o),h=new THREE.Vector3(Math.cos(H*(M+1.5))*o,(V+1)*R-r/2,Math.sin(H*(M+1.5))*o),n=i.push(s)-1,E=i.push(a)-1,u=i.push(c)-1,w=i.push(h)-1,m.push(new THREE.Face3(u,n,E),new THREE.Face3(u,E,w))}return p.mergeVertices(),p.computeVertexNormals(),p.computeFaceNormals(),p};

},{}],14:[function(require,module,exports){
function worldPositionVelocityUpdater(e,i,o,t){var n=new THREE.Vector3,r=new THREE.Vector3;return e.setVector(o,i),function(){e.setVector(n,i),r.subVectors(n,o),r.lengthSq()>2500?r.set(0,0,0):(n.lerp(o,.5),r.lerp(t,.95)),t.copy(r),o.copy(n)}}function shipPositionUniforms(e,i,o){var t=new THREE.Vector3,n=new THREE.Vector3;i.uniforms.shipPosition={type:"v3",value:t},i.uniforms.shipVelocity={type:"v3",value:n},i.uniforms.time={type:"f",value:0},e.on("update",worldPositionVelocityUpdater(e.coordinates,e.ship.position,t,n))}var glslify=require("glslify"),createShader=require("three-glslify")(THREE),createWebGeometry=require("./geometry"),Web=function(e,i){this.poem=e;var o=createShader(require("glslify/simple-adapter.js")("\n#define GLSLIFY 1\n\nuniform vec3 shipPosition;\nuniform vec3 shipVelocity;\nattribute float time;\nvarying vec4 vColor;\nvoid main() {\n  float shipDistance = max(distance(shipPosition, position), 10.0);\n  vColor = vec4(1.0, 0.0, 0.0, 1.0) * 5.0 * length(shipVelocity) / shipDistance;\n  gl_Position = projectionMatrix * modelViewMatrix * vec4(position - shipVelocity * 50.0 / (shipDistance * 0.3), 1.0);\n}","\n#define GLSLIFY 1\n\nvarying vec4 vColor;\nvoid main() {\n  gl_FragColor = vec4(0.2, 0.3, 0.3, 0.1) + vColor;\n}",[{name:"shipPosition",type:"vec3"},{name:"shipVelocity",type:"vec3"}],[{name:"time",type:"float"}]));shipPositionUniforms(e,o,e.ship.position);var t=new THREE.ShaderMaterial(o),n=createWebGeometry(64,12,e.r,e.height),r=new THREE.Mesh(n,t);t.wireframe=!0,t.transparent=!0,e.scene.add(r)};module.exports=Web;

},{"./geometry":13,"glslify":50,"glslify/simple-adapter.js":51,"three-glslify":73}],15:[function(require,module,exports){
function dispatchChange(){exports.dispatch({type:"change",scores:scores})}function isRealNumber(e){return _.isNumber(e)&&!_.isNaN(e)}var localforage=require("localforage"),levels=require("../levels"),scores={},EventDispatcher=require("../utils/EventDispatcher"),exports={get:function(e){var s=isRealNumber(scores[e])?scores[e]:0,r=_.isNumber(levels[e].maxScore)?levels[e].maxScore:1,t=1;r>0&&(t=s/r);var o=Math.round(100*t),c={value:s,total:r,unitI:t,percent:o};return _.each(c,function(e){_.isNaN(e)}),c},set:function(e,s){isRealNumber(s)&&(scores[e]=isRealNumber(scores[e])?Math.max(scores[e],s):s,localforage.setItem("scores",scores),dispatchChange())},reset:function(){scores={},localforage.setItem("scores",scores),dispatchChange()}};EventDispatcher.prototype.apply(exports),function(){localforage.getItem("scores",function(e,s){e||(scores=_.isObject(s)?s:{},dispatchChange())})}(),module.exports=exports;

},{"../levels":22,"../utils/EventDispatcher":40,"localforage":60}],16:[function(require,module,exports){
var random=require("../utils/random"),destroyMesh=require("../utils/destroyMesh"),twoπ=2*Math.PI,color=12339498,Arachnid=function(t,i,e,s){if(this.poem=t,this.manager=i,this.scene=t.scene,this.polarObj=new THREE.Object3D,this.object=null,this.name="Arachnid",this.color=12339498,this.cssColor="#BC492A",this.linewidth=2*this.poem.ratio,this.scoreValue=23,this.spawnPoint=new THREE.Vector2(e,s),this.position=new THREE.Vector2(e,s),this.dead=!1,this.speed=0,this.edgeAvoidanceBankSpeed=.04,this.edgeAvoidanceThrustSpeed=.001,this.thrustSpeed=.5,this.thrust=0,this.bankSpeed=.03,this.bank=0,this.maxSpeed=1e3,this.radius=3,this.addObject(),this.handleUpdate=this.update.bind(this),this.manager.on("update",this.handleUpdate),!_.isObject(this.poem.spiderlings))throw new Error("Arachnids require spiderlings")};module.exports=Arachnid,Arachnid.prototype={damageSettings:{color:12339498,transparent:!0,opacity:.5,retainExplosionsCount:3,perExplosion:20},initSharedAssets:function(t){var i=this.createGeometry();t.shared.geometry=i,t.on("update",Arachnid.prototype.updateGeometry(i))},updateGeometry:function(t){return function(i){_.each(t.waveyVerts,function(t){t.y=.8*Math.sin(i.time/100+t.x)+t.original.y})}},createGeometry:function(){var t,i,e,s;return t=new THREE.Geometry,i=[[373.9,249.2],[466,191.6],[556.7,314.2],[556.6,254],[454.9,138.8],[361.4,203.2],[354.8,187.6],[344.3,176.8],[332.8,170.9],[319,168.7],[303.3,171.6],[291.4,178.6],[282.6,188.6],[276.6,203.5],[182.8,138.8],[81,254],[80.9,314.2],[171.6,191.6],[263.7,249.2],[163.6,247.3],[91.6,354.6],[117.6,423.3],[169,290],[252.3,286.7],[186.4,321.4],[149.7,444.7],[183,498.7],[207.3,345.9],[252.3,326.1],[231.7,372.8],[259,417.4],[294,428.7],[261.1,376.5],[295,322.6],[319,316.1],[319,316.1],[342.8,322.6],[376.5,376.5],[343.6,428.7],[378.6,417.4],[405.9,372.8],[385.3,326],[430.3,345.8],[454.6,498.6],[487.9,444.6],[451.2,321.3],[385.3,286.6],[468.6,289.9],[519.9,423.2],[545.9,354.5],[473.9,247.2],[373.9,249.2]],e=_.reduce(i,function(t,i){return[t[0]+i[0],t[1]+i[1]]},[0,0]),s=[e[0]/i.length,e[1]/i.length],t.waveyVerts=[],t.vertices=_.map(i,function(i){var e=1/32,o=new THREE.Vector3((i[1]-s[1])*e*-1,(i[0]-s[0])*e,0);return o.original=(new THREE.Vector3).copy(o),(i[0]>400||i[0]<200)&&t.waveyVerts.push(o),o},this),t},addObject:function(){var t,i;t=this.manager.shared.geometry,i=new THREE.LineBasicMaterial({color:this.color,linewidth:this.linewidth}),this.object=new THREE.Line(t,i,THREE.LineStrip),this.object.scale.multiplyScalar(.6),this.object.position.z+=this.poem.r,this.polarObj.add(this.object),this.reset(),this.scene.add(this.polarObj),this.poem.on("destroy",destroyMesh(this.object))},kill:function(){this.dead=!0,this.object.visible=!1,this.damage.explode(this.position);for(var t=random.rangeInt(2,5),i=Math.atan2(this.poem.ship.position.y-this.position.y,this.poem.coordinates.keepDiffInRange(this.poem.ship.position.x-this.position.x)),e=.25*Math.PI,s=e/t,o=i+Math.PI,h=0;h<t;h++)this.poem.spiderlings.add(this.position.x,this.position.y,o+random.range(0,1)*(h*s-e/2))},reset:function(){this.position.copy(this.spawnPoint),this.speed=.2,this.bank=0},update:function(t){this.dead?this.damage.update(t):(this.bank*=.9,this.thrust=.01,this.bank+=random.range(-.01,.01),this.object.geometry.verticesNeedUpdate=!0,this.updateEdgeAvoidance(t),this.updatePosition(t))},updateEdgeAvoidance:function(t){var i,e,s,o,h,n;e=this.poem.height/2,i=.8*e,s=this.object.position.y,n=Math.abs(s);this.object.rotation.z/Math.PI;if(this.object.rotation.z%=2*Math.PI,this.object.rotation.z<0&&(this.object.rotation.z+=2*Math.PI),Math.abs(s)>i){var a=this.object.rotation.z>=.5*Math.PI&&this.object.rotation.z<1.5*Math.PI;h=s>0?a?1:-1:a?-1:1,o=(n-i)/(e-i),this.thrust+=o*this.edgeAvoidanceThrustSpeed,this.object.rotation.z+=h*o*this.edgeAvoidanceBankSpeed}},updatePosition:function(t){new THREE.Vector3;return function(){var t;this.object.rotation.z+=this.bank,t=this.object.rotation.z,this.speed*=.98,this.speed+=this.thrust,this.speed=Math.min(this.maxSpeed,this.speed),this.speed=Math.max(0,this.speed),this.position.x+=this.speed*Math.cos(t),this.position.y+=this.speed*Math.sin(t),this.object.position.y=this.position.y,this.polarObj.rotation.y=this.position.x*this.poem.circumferenceRatio}}()};

},{"../utils/destroyMesh":43,"../utils/random":44}],17:[function(require,module,exports){
var _=require("underscore"),destroyMesh=require("../utils/destroyMesh"),Asteroid=function(t,i,o,e){this.poem=t,this.object=null,this.position=new THREE.Vector2,this.position.x=i||0,this.position.y=o||0,this.oscillation=0,this.radius=e||5,this.speed=new THREE.Vector2,this.rotationSpeed=new THREE.Vector3,this.maxSpeed=.5,this.maxRotationSpeed=.1,this.oscillationSpeed=50,this.strokeColor=14540253,this.fillColor=16777215,this.addObject(i,o),this.update()};module.exports=Asteroid,Asteroid.prototype={addObject:function(){var t=new THREE.OctahedronGeometry(this.radius,1);_.each(t.vertices,function(t){t.x+=this.radius/2*(Math.random()-.5),t.y+=this.radius/2*(Math.random()-.5),t.z+=this.radius/2*(Math.random()-.5)},this);var i=new THREE.MeshBasicMaterial({color:this.strokeColor});this.object=new THREE.Mesh(t,i);var o=new THREE.MeshBasicMaterial({color:this.fillColor,side:THREE.BackSide}),e=new THREE.Mesh(t,o);e.scale.multiplyScalar(1.05),this.object.add(e),this.poem.scene.add(this.object),this.poem.on("destroy",destroyMesh(this.object)),this.speed.x=(.5-Math.random())*this.maxSpeed,this.speed.y=(.5-Math.random())*this.maxSpeed,this.rotationSpeed.x=(.5-Math.random())*this.maxRotationSpeed,this.rotationSpeed.y=(.5-Math.random())*this.maxRotationSpeed,this.rotationSpeed.z=(.5-Math.random())*this.maxRotationSpeed,this.oscillation=Math.random()*Math.PI*2*this.oscillationSpeed},update:function(t){this.oscillation+=this.speed.y,this.position.x+=this.speed.x,this.position.y=Math.sin(this.oscillation/this.oscillationSpeed)*this.poem.height,this.object.rotation.x+=this.rotationSpeed.x,this.object.rotation.y+=this.rotationSpeed.y,this.object.rotation.z+=this.rotationSpeed.z,this.poem.coordinates.setVector(this.object.position,this.position)}};

},{"../utils/destroyMesh":43,"underscore":75}],18:[function(require,module,exports){
var Bullet=function(t,i,e){this.poem=t,this.gun=i,this.vertex=e,this.speed=new THREE.Vector2(0,0),this.position=new THREE.Vector2(0,0),this.radius=1,this.bornAt=0,this.alive=!1};module.exports=Bullet,Bullet.prototype={kill:function(){this.vertex.set(0,0,1e3),this.alive=!1},update:function(t){this.position.x+=this.speed.x,this.position.y+=this.speed.y,this.poem.coordinates.setVector(this.vertex,this.position)},fire:function(t,i,e,s){this.poem.coordinates.setVector(this.vertex,t,i),this.position.set(t,i),this.speed.x=Math.cos(s)*e,this.speed.y=Math.sin(s)*e,this.bornAt=this.poem.clock.time,this.alive=!0}};

},{}],19:[function(require,module,exports){
var Damage=require("../components/Damage"),random=require("../utils/random"),destroyMesh=require("../utils/destroyMesh"),color=13317866,Jellyship=function(t,e,i,s){this.poem=t,this.manager=e,this.scene=t.scene,this.polarObj=new THREE.Object3D,this.object=null,this.name="Jellyship",this.color=color,this.cssColor="#CB36EA",this.linewidth=2*this.poem.ratio,this.scoreValue=13,this.spawnPoint=new THREE.Vector2(i,s),this.position=new THREE.Vector2(i,s),this.dead=!1,this.speed=0,this.edgeAvoidanceBankSpeed=.04,this.edgeAvoidanceThrustSpeed=.001,this.thrustSpeed=1,this.thrust=0,this.bankSpeed=.06,this.bank=0,this.maxSpeed=1e3,this.radius=3,this.addObject(),this.handleUpdate=this.update.bind(this),this.manager.on("update",this.handleUpdate)};module.exports=Jellyship,Jellyship.prototype={damageSettings:{color:13317866},initSharedAssets:function(t){var e=this.createGeometry();t.shared.geometry=e,t.on("update",Jellyship.prototype.updateWaveyVerts(e))},updateWaveyVerts:function(t){return function(e){_.each(t.waveyVerts,function(t){t.y=.8*Math.sin(e.time/100+t.x)+t.original.y})}},createGeometry:function(){var t,e,i,s;return t=new THREE.Geometry,e=[[355.7,211.7],[375.8,195.9],[368.5,155.4],[361.4,190.8],[341.3,205.9],[320.4,201.8],[298.9,206],[278.6,190.8],[271.5,155.4],[264.2,195.9],[284.7,212],[258.3,239.2],[242.3,228.5],[238.3,168.9],[226.1,237.1],[246.7,266.2],[233.7,316.4],[259.2,321.2],[257.1,331.3],[254.9,342.3],[252.8,352.9],[250.5,364.5],[248.2,375.7],[246.1,386.2],[243.8,397.7],[241.3,410.3],[239.5,419.3],[237.4,429.6],[253.1,432.7],[254.9,423.7],[256.9,414.1],[259.3,401.8],[261.6,390.2],[263.7,380.1],[266.1,367.8],[268.3,356.9],[270.6,345.6],[272.7,335.1],[274.9,324.2],[293,327.6],[292.6,336.5],[292.2,348],[291.7,359.6],[291.2,371.5],[290.7,382.5],[290.3,393.6],[289.8,405.1],[289.5,414.1],[289,425.6],[288.5,437],[288.1,448.5],[287.6,459.5],[287.1,471.5],[286.6,484],[302.6,484.6],[303.1,473.5],[303.6,461.5],[304.1,448.5],[304.5,438.5],[305,425.1],[305.4,416.1],[305.9,405],[306.2,395.5],[306.6,386],[307.1,373],[307.6,361],[308.2,347.5],[308.5,338.5],[308.9,330.6],[331.1,330.8],[331.4,336.5],[331.7,344],[332,353],[332.5,364.5],[333,376],[333.4,387.5],[333.9,398.5],[334.4,410.5],[334.9,422.4],[335.4,437],[336,450],[336.4,460],[336.8,471],[337.4,484.6],[353.4,484],[352.8,471],[352.3,457.5],[351.9,448],[351.5,437.5],[350.9,423],[350.4,410.5],[349.8,396.5],[349.4,385.5],[348.9,374.4],[348.5,363.4],[348,352],[347.6,343],[347.3,334],[347,327.8],[365.1,324.3],[366.6,331.7],[368.2,339.6],[370.2,349.5],[371.9,357.8],[373.6,366.8],[375.4,375.4],[377.1,384],[379,393.5],[381.2,404.6],[383.1,414],[384.9,422.8],[386.9,432.7],[402.6,429.6],[400.6,419.6],[399.1,412.5],[397.1,402.5],[394.7,390.2],[393.1,382.6],[391.4,374],[389.6,365],[387.6,355.1],[386,347.2],[384.1,337.7],[382.7,330.6],[380.9,321.4],[407,316.4],[393.8,265.5],[413.9,237.1],[401.7,168.9],[397.7,228.5],[382.1,238.9],[355.9,211.8]],i=_.reduce(e,function(t,e){return[t[0]+e[0],t[1]+e[1]]},[0,0]),s=[i[0]/e.length,i[1]/e.length],t.waveyVerts=[],t.vertices=_.map(e,function(e){var i=1/32,o=new THREE.Vector3((e[1]-s[1])*i*-1,(e[0]-s[0])*i,0);return o.original=(new THREE.Vector3).copy(o),e[1]>330.8&&t.waveyVerts.push(o),o},this),t},addObject:function(){var t,e;t=this.manager.shared.geometry,e=new THREE.LineBasicMaterial({color:this.color,linewidth:this.linewidth}),this.object=new THREE.Line(t,e,THREE.LineStrip),this.object.position.z+=this.poem.r,this.polarObj.add(this.object),this.reset(),this.scene.add(this.polarObj),this.poem.on("destroy",destroyMesh(this.object))},kill:function(){this.dead=!0,this.object.visible=!1,this.damage.explode(this.position)},reset:function(){this.position.copy(this.spawnPoint),this.speed=.2,this.bank=0},update:function(t){this.dead?this.damage.update(t):(this.bank*=.9,this.thrust=.01,this.bank+=random.range(-.01,.01),this.object.geometry.verticesNeedUpdate=!0,this.updateEdgeAvoidance(t),this.updatePosition(t))},updateEdgeAvoidance:function(t){var e,i,s,o,h,a;i=this.poem.height/2,e=.8*i,s=this.object.position.y,a=Math.abs(s);this.object.rotation.z/Math.PI;if(this.object.rotation.z%=2*Math.PI,this.object.rotation.z<0&&(this.object.rotation.z+=2*Math.PI),Math.abs(s)>e){var n=this.object.rotation.z>=.5*Math.PI&&this.object.rotation.z<1.5*Math.PI;h=s>0?n?1:-1:n?-1:1,o=(a-e)/(i-e),this.thrust+=o*this.edgeAvoidanceThrustSpeed,this.object.rotation.z+=h*o*this.edgeAvoidanceBankSpeed}},updatePosition:function(t){new THREE.Vector3;return function(){var t;this.object.rotation.z+=this.bank,t=this.object.rotation.z,this.speed*=.98,this.speed+=this.thrust,this.speed=Math.min(this.maxSpeed,this.speed),this.speed=Math.max(0,this.speed),this.position.x+=this.speed*Math.cos(t),this.position.y+=this.speed*Math.sin(t),this.object.position.y=this.position.y,this.polarObj.rotation.y=this.position.x*this.poem.circumferenceRatio}}()};

},{"../components/Damage":7,"../utils/destroyMesh":43,"../utils/random":44}],20:[function(require,module,exports){
var random=require("../utils/random"),destroyMesh=require("../utils/destroyMesh"),color=16711680,Spiderling=function(t,i,e,o,s){this.poem=t,this.manager=i,this.scene=t.scene,this.polarObj=new THREE.Object3D,this.object=null,this.name="Spiderling",this.color=color,this.cssColor="#ff0000",this.linewidth=2*this.poem.ratio,this.scoreValue=-5,this.spawnPoint=new THREE.Vector2(e,o),this.position=new THREE.Vector2(e,o),this.unitDirection=new THREE.Vector2(Math.cos(s),Math.sin(s)),this.list=random.range(-Math.PI/8,Math.PI/8),this.dead=!1,this.speed=.02,this.radius=1.5,this.thetaJitter=random.range(.2*-Math.PI,.2*Math.PI),this.addObject(),this.damage=i.damage,this.handleUpdate=this.update.bind(this),this.manager.on("update",this.handleUpdate)};module.exports=Spiderling,Spiderling.prototype={damageSettings:{color:color,transparent:!0,opacity:.5,retainExplosionsCount:3,perExplosion:5},initSharedAssets:function(t){var i=this.createGeometry();t.shared.geometry=i,t.on("update",Spiderling.prototype.updateGeometry(i))},updateGeometry:function(t){return function(i){var e=i.time/100,o=6*Math.PI/t.waveyVerts.length;_.each(t.waveyVerts,function(t,i){var s=.8*Math.sin(i*o+e)+.2;t.x=s*t.original.x,t.y=s*t.original.y})}},createGeometry:function(){var t,i,e,o;t=new THREE.Geometry;var s=16,n=2*Math.PI/(s-1);return i=_.map(_.range(s),function(t){return[2*Math.cos(t*n),2*Math.sin(t*n)]}),e=_.reduce(i,function(t,i){return[t[0]+i[0],t[1]+i[1]]},[0,0]),o=[e[0]/i.length,e[1]/i.length],t.waveyVerts=[],t.vertices=_.map(i,function(i,e){var s=1,n=new THREE.Vector3((i[1]-o[1])*s*-1,(i[0]-o[0])*s,0);return n.original=(new THREE.Vector3).copy(n),e%2===0&&t.waveyVerts.push(n),n},this),t},addObject:function(){var t,i;t=this.manager.shared.geometry,i=new THREE.LineBasicMaterial({color:this.color,linewidth:this.linewidth}),this.object=new THREE.Line(t,i,THREE.LineStrip),this.object.scale.multiplyScalar(random.range(.3,.8)),this.object.position.z+=this.poem.r,this.polarObj.add(this.object),this.reset(),this.scene.add(this.polarObj),this.poem.on("destroy",destroyMesh(this.object))},kill:function(){this.dead=!0,this.object.visible=!1,this.damage.explode(this.position)},reset:function(){this.position.copy(this.spawnPoint),this.bank=0},update:function(t){this.dead?this.damage.update(t):(this.object.geometry.verticesNeedUpdate=!0,this.updatePosition(t))},updatePosition:function(){var t=new THREE.Vector2,i=new THREE.Vector2;return function(e){var o=Math.atan2(this.poem.ship.position.y-this.position.y,this.poem.coordinates.keepDiffInRange(this.poem.ship.position.x-this.position.x));t.x=Math.cos(o+this.list),t.y=Math.sin(o+this.list),i.copy(this.unitDirection).lerp(t,.02).normalize(),this.unitDirection.copy(i),i.multiplyScalar(this.speed*e.dt),this.position.add(i),this.object.position.y=this.position.y,this.polarObj.rotation.y=this.position.x*this.poem.circumferenceRatio}}()};

},{"../utils/destroyMesh":43,"../utils/random":44}],21:[function(require,module,exports){
var numberOfJellies=25;module.exports={name:"Polar Rocks",description:"Flight into the asteroid field",order:2,maxScore:13*numberOfJellies,config:{scoringAndWinning:{message:"Arachnids detected in the next sector.<br/>Please spare their babies.<br/>",nextLevel:"web",conditions:[{component:"jellyManager",properties:null}]},fog:{nearFactor:.25,farFactor:1.7}},objects:{rails:{object:require("../components/Rails"),properties:{}},asteroidField:{object:require("../managers/AsteroidField"),properties:{count:20}},jellyManager:{object:require("../managers/EntityManager"),properties:{entityType:require("../entities/Jellyship"),count:numberOfJellies}},cameraIntro:{object:require("../components/CameraIntro"),properties:{speed:.975,heightMultiplier:2}},music:{object:require("../sound/Music"),properties:{url:"https://soundcloud.com/theelectrochippers/the-end-of-our-journey"}}}};

},{"../components/CameraIntro":5,"../components/Rails":9,"../entities/Jellyship":19,"../managers/AsteroidField":26,"../managers/EntityManager":27,"../sound/Music":30}],22:[function(require,module,exports){
module.exports={asteroidsJellies:require("./asteroidsJellies"),titles:require("./titles"),intro:require("./intro"),web:require("./web")};

},{"./asteroidsJellies":21,"./intro":23,"./titles":24,"./web":25}],23:[function(require,module,exports){
var numberOfJellies=5;module.exports={name:"Intro",description:"Invasion of the Jellies",order:1,maxScore:13*numberOfJellies,config:{r:120,height:60,circumference:900,camera:{multiplier:2},scoringAndWinning:{message:"You saved this sector<br/>on to the next level.",nextLevel:"asteroidsJellies",conditions:[{component:"jellyManager",properties:null}]},stars:{count:3e3}},objects:{cylinderLines:{object:require("../components/CylinderLines"),properties:{}},cameraIntro:{object:require("../components/CameraIntro"),properties:{speed:.985}},jellyManager:{object:require("../managers/EntityManager"),properties:{entityType:require("../entities/Jellyship"),count:numberOfJellies}},music:{object:require("../sound/Music"),properties:{url:"https://soundcloud.com/theelectrochippers/the-sun-is-rising-chip-music"}}}};

},{"../components/CameraIntro":5,"../components/CylinderLines":6,"../entities/Jellyship":19,"../managers/EntityManager":27,"../sound/Music":30}],24:[function(require,module,exports){
module.exports={config:{},objects:{titles:{object:require("../components/Titles"),properties:{}},music:{object:require("../sound/Music"),properties:{url:"https://soundcloud.com/theelectrochippers/chiptune-space",startTime:12,volume:1}}}};

},{"../components/Titles":12,"../sound/Music":30}],25:[function(require,module,exports){
var numberOfArachnids=20;module.exports={name:"Stuck in the Web",description:"Don't hurt the babies",maxScore:23*numberOfArachnids,order:3,config:{r:110,camera:{multiplier:2},scoringAndWinning:{message:"Hopefully the spiderlings will grow into pleasant individuals. Follow me on <a href='https://twitter.com/tatumcreative'>Twitter</a> for updates on new levels.",nextLevel:"titles",conditions:[{component:"arachnids",properties:null}]},stars:{count:3e3}},objects:{web:{object:require("../components/Web"),properties:{}},spiderlings:{object:require("../managers/EntityManager"),properties:{entityType:require("../entities/Spiderlings"),count:0}},arachnids:{object:require("../managers/EntityManager"),properties:{entityType:require("../entities/Arachnid"),count:numberOfArachnids}},music:{object:require("../sound/Music"),properties:{url:"https://soundcloud.com/theelectrochippers/electrochip-artillery"}}}};

},{"../components/Web":14,"../entities/Arachnid":16,"../entities/Spiderlings":20,"../managers/EntityManager":27,"../sound/Music":30}],26:[function(require,module,exports){
var Asteroid=require("../entities/Asteroid"),random=require("../utils/random.js"),AsteroidField=function(i,e){this.poem=i,this.asteroids=[],this.maxRadius=50,this.range=[.2,1],this.originClearance=30,this.count=20,_.extend(this,e),this.generate(this.count),this.poem.on("update",this.update.bind(this)),this.poem.gun.setBarrierCollider(this.asteroids)};module.exports=AsteroidField,AsteroidField.prototype={generate:function(i){var e,t,s,o,r,n;for(o=4*this.poem.height,r=this.poem.circumference,e=0;e<i;e++){do t=random.range(.1*r,.9*r),s=random.range(-o/2,o/2),n=random.range(this.range[0],this.range[1])*this.maxRadius;while(this.checkCollision(t,s,n)&&this.checkFreeOfOrigin(t,s,n));this.asteroids.push(new Asteroid(this.poem,t,s,n))}},update:function(i){if(_.each(this.asteroids,function(e){e.update(i)},this),!this.poem.ship.dead&&!this.poem.ship.invulnerable){var e=this.checkCollision(this.poem.ship.position.x,this.poem.ship.position.y,2);e&&this.poem.ship.kill()}},checkFreeOfOrigin:function(i,e,t){return Math.sqrt(i*i+e*e)>t+this.originClearance},checkCollision:function(i,e,t){var s=_.find(this.asteroids,function(s){var o,r,n;return o=this.poem.coordinates.circumferenceDistance(i,s.position.x),r=e-s.position.y,n=Math.sqrt(o*o+r*r),n<t+s.radius},this);return!!s}};

},{"../entities/Asteroid":17,"../utils/random.js":44}],27:[function(require,module,exports){
var Collider=require("../utils/Collider"),DefaultJellyShip=require("../entities/JellyShip"),EventDispatcher=require("../utils/EventDispatcher"),Damage=require("../components/Damage"),EntityManager=function(i,t){this.poem=i,this.entityType=DefaultJellyShip,this.count=20,this.entities=[],this.liveEntities=[],this.originClearance=300,this.shared={},this.winCheck=null,_.extend(this,t),this.damage=new Damage(this.poem,this.entityType.prototype.damageSettings),_.isFunction(this.entityType.prototype.initSharedAssets)&&this.entityType.prototype.initSharedAssets(this),this.generate(this.count),this.configureCollider(),this.boundUpdate=this.update.bind(this),this.poem.on("update",this.boundUpdate)};module.exports=EntityManager,EntityManager.prototype={generate:function(i){var t,e,n,s,h,o;for(s=4*this.poem.height,h=this.poem.circumference,t=0;t<i;t++)e=Math.random()*h,n=Math.random()*s-s/2,o=new this.entityType(this.poem,this,e,n),o.damage=this.damage,this.entities.push(o),this.liveEntities.push(o);this.poem.scoringAndWinning.adjustEnemies(i)},add:function(i,t,e){var n=new this.entityType(this.poem,this,i,t,e);n.bank=e,n.update({dt:0}),this.entities.push(n),this.liveEntities.push(n),this.poem.scoringAndWinning.adjustEnemies(1)},update:function(i){this.dispatch(i)},killEntity:function(i){var t=this.liveEntities.indexOf(i);t>=0&&this.liveEntities.splice(t,1),i.kill(),this.winCheck&&0===this.liveEntities.length&&(this.winCheck.reportConditionCompleted(),this.winCheck=null)},configureCollider:function(){new Collider(this.poem,function(){return this.liveEntities}.bind(this),function(){return this.poem.gun.liveBullets}.bind(this),function(i,t){this.killEntity(i),this.poem.gun.killBullet(t);var e=i.scoreValue>0?"+":"",n=i.scoreValue>0?i.cssColor:"#ff0000";0!==i.scoreValue&&this.poem.scoringAndWinning.adjustScore(i.scoreValue,e+i.scoreValue+" "+i.name,{color:n}),this.poem.scoringAndWinning.adjustEnemies(-1)}.bind(this)),new Collider(this.poem,function(){return this.liveEntities}.bind(this),function(){return[this.poem.ship]}.bind(this),function(i,t){this.poem.ship.dead||this.poem.ship.invulnerable||(this.killEntity(i),this.poem.ship.kill(),this.poem.scoringAndWinning.adjustEnemies(-1))}.bind(this))},watchForCompletion:function(i,t){this.winCheck=i}},EventDispatcher.prototype.apply(EntityManager.prototype);

},{"../components/Damage":7,"../entities/JellyShip":19,"../utils/Collider":38,"../utils/EventDispatcher":40}],28:[function(require,module,exports){
var Bullet=require("../entities/Bullet"),Collider=require("../utils/Collider"),SoundGenerator=require("../sound/SoundGenerator"),destroyMesh=require("../utils/destroyMesh"),Gun=function(e){this.poem=e,this.object=null,this.sound=null,this.count=350,this.bulletAge=5e3,this.fireDelayMilliseconds=100,this.lastFireTimestamp=this.poem.clock.time,this.liveBullets=[],this.bullets=[],this.bornAt=0,this.addObject(),this.addSound(),this.poem.on("update",this.update.bind(this))};module.exports=Gun,Gun.prototype={fire:function(){var e=function(e){return!e.alive};return function(t,i,s,l){var n=this.poem.clock.time;if(!(n-this.lastFireTimestamp<this.fireDelayMilliseconds)){this.lastFireTimestamp=n;var o=_.find(this.bullets,e);if(o){this.liveBullets.push(o),o.fire(t,i,s,l);var r=1900,u=this.sound;u.setGain(.1,0,.001),u.setFrequency(r,0,0),u.setFrequency(.1*r,.01,.05),setTimeout(function(){u.setGain(0,.01,.05)},50)}}}}(),generateGeometry:function(){for(var e,t,i=new THREE.Geometry,s=0;s<this.count;s++)e=new THREE.Vector3,t=new Bullet(this.poem,this,e),i.vertices.push(e),this.bullets.push(t),t.kill();return i},killBullet:function(e){var t=this.liveBullets.indexOf(e);t>=0&&this.liveBullets.splice(t,1),e.kill(),this.object&&(this.object.geometry.verticesNeedUpdate=!0)},addObject:function(){var e;e=this.generateGeometry(),this.object=new THREE.PointCloud(e,new THREE.PointCloudMaterial({size:1*this.poem.ratio,color:16711680})),this.object.frustumCulled=!1,this.poem.scene.add(this.object),this.poem.on("destroy",destroyMesh(this.object))},update:function(e){for(var t,i=0;i<this.liveBullets.length;i++)t=this.liveBullets[i],t.bornAt+this.bulletAge<e.time?(this.killBullet(t),i--):t.update(e.dt);this.liveBullets.length>0&&(this.object.geometry.verticesNeedUpdate=!0)},setBarrierCollider:function(e){new Collider(this.poem,function(){return e}.bind(this),function(){return this.liveBullets}.bind(this),function(e,t){this.killBullet(t)}.bind(this))},addSound:function(){var e=this.sound=new SoundGenerator;e.connectNodes([e.makeOscillator("square"),e.makeGain(),e.getDestination()]),e.setGain(0,0,0),e.start(),this.poem.on("destroy",function(){e.destroy()})}};

},{"../entities/Bullet":18,"../sound/SoundGenerator":31,"../utils/Collider":38,"../utils/destroyMesh":43}],29:[function(require,module,exports){
var crossroads=require("crossroads"),hasher=require("hasher"),levelLoader=require("./levelLoader"),baseUrl="/polar",defaultLevel="titles",currentLevel="",routing={start:function(e,a){function r(e,a){crossroads.parse(e)}levelLoader.init(e,a),crossroads.addRoute("/",routing.showMainTitles),crossroads.addRoute("level/{name}",routing.loadUpALevel),crossroads.addRoute(/.*/,function(){hasher.replaceHash("")}),hasher.initialized.add(r),hasher.changed.add(r),hasher.init()},showMainTitles:function(){_gaq.push(["_trackPageview",baseUrl]),levelLoader.load(defaultLevel)},loadUpALevel:function(e){_gaq.push(["_trackPageview",baseUrl+"/#level/"+e]);var a=levelLoader.load(e);a||levelLoader.load(defaultLevel)},on:levelLoader.on.bind(levelLoader),off:levelLoader.off.bind(levelLoader)};module.exports=routing;

},{"./levelLoader":1,"crossroads":48,"hasher":52}],30:[function(require,module,exports){
var soundcloud=require("soundcloud-badge"),muter=require("./muter"),soundOff=!1,audio=null,fetchAndPlaySong=null,timesCalledSoundcloud=0,Music=function(u,o){fetchAndPlaySong=function(){var d=++timesCalledSoundcloud;soundcloud({client_id:"6057c9af862bf245d4c402179e317f52",song:o.url,dark:!1,getFonts:!1},function(u,n,e,t){if(d===timesCalledSoundcloud&&!muter.muted){if(u)throw u;audio=new Audio,audio.src=n,audio.play(),audio.loop=!0,audio.volume=o.volume||.6,$(audio).on("loadedmetadata",function(){audio&&(audio.currentTime=o.startTime||0)})}}),u.on("destroy",function(){audio&&(audio.pause(),audio=null),$(".npm-scb-white").remove()})},muter.muted||(fetchAndPlaySong(),fetchAndPlaySong=null)};Music.prototype.muted=!1,muter.on("mute",function(u){audio&&audio.pause(),$(".npm-scb-white").hide()}),muter.on("unmute",function(u){audio&&audio.play(),fetchAndPlaySong&&(fetchAndPlaySong(),fetchAndPlaySong=null),$(".npm-scb-white").show()}),module.exports=Music;

},{"./muter":32,"soundcloud-badge":65}],31:[function(require,module,exports){
var _=require("underscore"),context=window.AudioContext||window.webkitAudioContext||null,muter=require("./muter"),SoundGenerator=function(){this.enabled=void 0!==context,this.enabled&&(this.lastGainValue=null,this.nodes=[],this.totalCreated++,this.totalCreatedSq=this.totalCreated*this.totalCreated,muter.on("mute",this.handleMute.bind(this)),muter.on("unmute",this.handleUnMute.bind(this)))};module.exports=SoundGenerator,SoundGenerator.prototype={handleMute:function(){this.gain&&(this.gain.gain.value=0)},handleUnMute:function(){this.gain&&_.isNumber(this.lastGainValue)&&(this.gain.gain.value=this.lastGainValue)},context:context?new context:void 0,makePinkNoise:function(t){var e,n,i,s,a,o,r,u;return e=n=i=s=a=o=r=0,u=this.pinkNoise=this.context.createScriptProcessor(t,1,1),u.onaudioprocess=function(u){for(var c=u.outputBuffer.getChannelData(0),h=0;h<t;h++){var l=2*Math.random()-1;e=.99886*e+.0555179*l,n=.99332*n+.0750759*l,i=.969*i+.153852*l,s=.8665*s+.3104856*l,a=.55*a+.5329522*l,o=-.7616*o-.016898*l,c[h]=e+n+i+s+a+o+r+.5362*l,c[h]*=.11,r=.115926*l}},this.nodes.push(u),u},makeOscillator:function(t,e){var n=this.oscillator=this.context.createOscillator();return n.type=t||"sawtooth",n.frequency.value=e||2e3,this.nodes.push(n),n},makeGain:function(){var t=this.gain=this.context.createGain();return t.gain.value=0,this.nodes.push(t),t},makePanner:function(){this.context.listener.setPosition(0,0,0);var t=this.panner=this.context.createPanner();return t.panningModel="equalpower",t.coneOuterGain=.1,t.coneOuterAngle=180,t.coneInnerAngle=0,this.nodes.push(t),t},makeBandpass:function(){var t=this.bandpass=this.context.createBiquadFilter();return t.type="bandpass",t.frequency.value=440,t.Q.value=.5,this.nodes.push(t),t},getDestination:function(){return this.context.destination},connectNodes:function(t){_.each(_.rest(t),function(e,n,i){var s=t[n];s.connect(e)})},start:function(){this.oscillator.start(0)},totalCreated:0,setFrequency:function(t,e,n){this.enabled&&this.oscillator.frequency.setTargetAtTime(t,this.context.currentTime+e,Math.max(.001,n))},setPosition:function(t,e,n){this.enabled&&this.panner.setPosition(t,e,n)},setGain:function(t,e,n){this.lastGainValue=t,this.enabled&&!muter.muted&&this.gain.gain.setTargetAtTime(t,this.context.currentTime+e,Math.max(n,.001))},setBandpassQ:function(t){this.enabled&&this.bandpass.Q.setTargetAtTime(t,this.context.currentTime,.1)},setBandpassFrequency:function(t){this.enabled&&this.bandpass.frequency.setTargetAtTime(t,this.context.currentTime,.1)},destroy:function(){console.log("Destroying this sound generator"),this.nodes.forEach(function(t){t.disconnect()})}};

},{"./muter":32,"underscore":75}],32:[function(require,module,exports){
var EventDispatcher=require("../utils/EventDispatcher"),localforage=require("localforage"),muter,Muter=function(){this.muted=!0,localforage.getItem("muted",function(t,e){t||null===e?this.muted=!1:this.muted=e,this.dispatchChanged()}.bind(this))};Muter.prototype={mute:function(){this.muted=!0,this.dispatchChanged(),this.save()},unmute:function(){this.muted=!1,this.dispatchChanged(),this.save()},save:function(){localforage.setItem("muted",this.muted)},dispatchChanged:function(){this.muted?muter.dispatch({type:"mute"}):muter.dispatch({type:"unmute"})}},EventDispatcher.prototype.apply(Muter.prototype),muter=new Muter,$(window).on("keydown",function(t){83===t.keyCode&&(muter.muted?muter.unmute():muter.mute())}),module.exports=muter;

},{"../utils/EventDispatcher":40,"localforage":60}],33:[function(require,module,exports){
var menu=require("./menu"),mute=require("./mute"),menuLevels=require("./menuLevels");jQuery(function(e){menu.setHandlers(),mute.setHandlers()});

},{"./menu":34,"./menuLevels":35,"./mute":36}],34:[function(require,module,exports){
var EventDispatcher=require("../utils/EventDispatcher"),routing=require("../routing"),scores=require("../components/scores"),poem,isOpen=!1,$body;routing.on("newLevel",function(e){poem=e.poem});var menu={setHandlers:function(){$body=$("body"),$("#menu a, #container-blocker").click(menu.close),$("#menu-button").off().click(this.toggle),$("#menu-reset-score").off().click(this.resetScores),routing.on("newLevel",menu.close),$(window).on("keydown",function(e){27===e.keyCode&&menu.toggle(e)})},resetScores:function(e){e.preventDefault(),confirm("Are you sure you want to reset your scores?")&&scores.reset()},toggle:function(e){e.preventDefault(),isOpen?menu.close():menu.open(),isOpen=!isOpen},close:function(){$body.removeClass("menu-open"),poem&&poem.start()},open:function(){$body.addClass("menu-open"),poem&&poem.pause()}};EventDispatcher.prototype.apply(menu),module.exports=menu;

},{"../components/scores":15,"../routing":29,"../utils/EventDispatcher":40}],35:[function(require,module,exports){
function reactiveLevels(e,r){e.children().remove();var t=_.map(levelKeyPairs,function(e){var r=e[0],t=e[1],n=scores.get(r);return{name:t.name,description:t.description,slug:r,percent:n?n.percent:0,score:n?n.value:0,total:n?n.total:1,leftOrRight:n&&n.unitI<.5?"right":"left"}});e.append(_.reduce(t,function(e,t){return e+r(t)},""))}var scores=require("../components/scores"),levelKeyPairs=function(e){return _.chain(e).pairs().filter(function(e){return e[1].order}).sortBy(function(e){return e[1].order}).value()}(require("../levels"));!function(){function e(){reactiveLevels(t,r)}var r=_.template($("#menu-level-template").text()),t=$("#menu-levels");scores.on("change",e),e()}();

},{"../components/scores":15,"../levels":22}],36:[function(require,module,exports){
var muter=require("../sound/muter"),mutedSrc="assets/images/sound-mute.png",unMutedSrc="assets/images/sound-unmute.png",mutedSrcHover="assets/images/sound-mute-hover.png",unMutedSrcHover="assets/images/sound-unmute-hover.png";(new Image).src=mutedSrc,(new Image).src=unMutedSrc,(new Image).src=mutedSrcHover,(new Image).src=unMutedSrcHover;var $mute,$img;module.exports={setHandlers:function(){$mute=$("#mute"),$img=$mute.find("img"),muter.on("mute",function(){$img.attr("src",mutedSrc)}),muter.on("unmute",function(){$img.attr("src",unMutedSrc)}),$img.attr("src",muter.muted?mutedSrc:unMutedSrc),$mute.off().click(function(e){e.preventDefault(),muter.muted?($img.attr("src",unMutedSrcHover),muter.unmute()):($img.attr("src",mutedSrcHover),muter.mute()),e.stopImmediatePropagation()}),$mute.on("mouseover",function(e){e.preventDefault(),muter.muted?$img.attr("src",mutedSrcHover):$img.attr("src",unMutedSrcHover)}),$mute.on("mouseout",function(e){muter.muted?$img.attr("src",mutedSrc):$img.attr("src",unMutedSrc)})}};

},{"../sound/muter":32}],37:[function(require,module,exports){
var Clock=function(t){this.maxDt=60,this.minDt=16,this.pTime=0,this.time=0,t!==!1&&this.start()};module.exports=Clock,Clock.prototype={start:function(){this.pTime=Date.now()},getDelta:function(){var t,i;return t=Date.now(),i=t-this.pTime,i=Math.min(i,this.maxDt),i=Math.max(i,this.minDt),this.time+=i,this.pTime=t,i}};

},{}],38:[function(require,module,exports){
var _=require("underscore"),Collider=function(i,t,o,e){this.poem=i,this.getCollectionA=t,this.getCollectionB=o,this.onCollision=e,this.poem.on("update",this.update.bind(this))};module.exports=Collider,Collider.prototype={update:function(i){var t=[];_.each(this.getCollectionA(),function(i){var o=_.find(this.getCollectionB(),function(t){var o,e,n;return o=this.poem.coordinates.circumferenceDistance(i.position.x,t.position.x),e=i.position.y-t.position.y,n=Math.sqrt(o*o+e*e),n<i.radius+t.radius},this);o&&t.push([i,o])},this),_.each(t,function(i){this.onCollision(i[0],i[1])},this)}};

},{"underscore":75}],39:[function(require,module,exports){
var Coordinates=function(e){this.poem=e,this.twoRSquared=2*(this.poem.r*this.poem.r)};module.exports=Coordinates,Coordinates.prototype={x:function(e){return Math.sin(e*this.poem.circumferenceRatio)*this.poem.r},y:function(e){return e},z:function(e){return Math.cos(e*this.poem.circumferenceRatio)*this.poem.r},r:function(e,t){return Math.sqrt(e*e+t*t)},theta:function(e,t){return Math.atan(t/e)},setVector:function(e){var t,n,r;return"number"==typeof arguments[1]?(t=arguments[1],n=arguments[2],e.set(this.x(t),n,this.z(t))):(r=arguments[1],e.set(this.x(r.x),r.y,this.z(r.x)))},getVector:function(e,t){var n=new THREE.Vector3;return this.setVector(n,e,t)},keepInRangeX:function(e){return e>=0?e%this.poem.circumference:e+e%this.poem.circumference},keepInRangeY:function(e){return e>=0?e%this.poem.height:e+e%this.poem.height},keepInRange:function(e){return e.x=this.keepInRangeX(e.x),e.y=this.keepInRangeY(e.y),e},keepDiffInRange:function(e){for(var t=this.poem.circumference;e<=t/-2;)e+=t;for(;e>t/2;)e-=t;return e},twoXToTheta:function(e){return e*this.poem.circumferenceRatio},circumferenceDistance:function(e,t){var n=this.poem.circumferenceRatio;return this.twoRSquared-this.twoRSquared*Math.cos(e*n-t*n)}};

},{}],40:[function(require,module,exports){
var EventDispatcher=function(){};EventDispatcher.prototype={constructor:EventDispatcher,apply:function(t){t.on=EventDispatcher.prototype.on,t.hasEventListener=EventDispatcher.prototype.hasEventListener,t.off=EventDispatcher.prototype.off,t.dispatch=EventDispatcher.prototype.dispatch},on:function(t,e){void 0===this._listeners&&(this._listeners={});var i=this._listeners;void 0===i[t]&&(i[t]=[]),i[t].indexOf(e)===-1&&i[t].push(e)},hasEventListener:function(t,e){if(void 0===this._listeners)return!1;var i=this._listeners;return void 0!==i[t]&&i[t].indexOf(e)!==-1},off:function(t,e){if(void 0!==this._listeners){var i=this._listeners,s=i[t];if(void 0!==s){var n=s.indexOf(e);n!==-1&&s.splice(n,1)}}},dispatch:function(t){if(void 0!==this._listeners){var e=this._listeners,i=e[t.type];if(void 0!==i){t.target=this;var s,n=[],r=i.length;for(s=0;s<r;s++)n[s]=i[s];for(s=0;s<r;s++)n[s].call(this,t)}}}},"object"==typeof module&&(module.exports=EventDispatcher);

},{}],41:[function(require,module,exports){
var Stats=function(){var e=Date.now(),t=e,n=0,i=1/0,a=0,d=0,o=1/0,l=0,s=0,r=0,c=document.createElement("div");c.id="stats",c.addEventListener("mousedown",function(e){e.preventDefault(),g(++r%2)},!1),c.style.cssText="width:80px;opacity:0.9;cursor:pointer";var p=document.createElement("div");p.id="fps",p.style.cssText="padding:0 0 3px 3px;text-align:left;background-color:#002",c.appendChild(p);var h=document.createElement("div");h.id="fpsText",h.style.cssText="color:#0ff;font-family:Helvetica,Arial,sans-serif;font-size:9px;font-weight:bold;line-height:15px",h.innerHTML="FPS",p.appendChild(h);var f=document.createElement("div");for(f.id="fpsGraph",f.style.cssText="position:relative;width:74px;height:30px;background-color:#0ff",p.appendChild(f);f.children.length<74;){var x=document.createElement("span");x.style.cssText="width:1px;height:30px;float:left;background-color:#113",f.appendChild(x)}var m=document.createElement("div");m.id="ms",m.style.cssText="padding:0 0 3px 3px;text-align:left;background-color:#020;display:none",c.appendChild(m);var u=document.createElement("div");u.id="msText",u.style.cssText="color:#0f0;font-family:Helvetica,Arial,sans-serif;font-size:9px;font-weight:bold;line-height:15px",u.innerHTML="MS",m.appendChild(u);var v=document.createElement("div");for(v.id="msGraph",v.style.cssText="position:relative;width:74px;height:30px;background-color:#0f0",m.appendChild(v);v.children.length<74;){var y=document.createElement("span");y.style.cssText="width:1px;height:30px;float:left;background-color:#131",v.appendChild(y)}var g=function(e){switch(r=e){case 0:p.style.display="block",m.style.display="none";break;case 1:p.style.display="none",m.style.display="block"}},b=function(e,t){var n=e.appendChild(e.firstChild);n.style.height=t+"px"};return{REVISION:12,domElement:c,setMode:g,begin:function(){e=Date.now()},end:function(){var r=Date.now();return n=r-e,i=Math.min(i,n),a=Math.max(a,n),u.textContent=n+" MS ("+i+"-"+a+")",b(v,Math.min(30,30-n/200*30)),s++,r>t+1e3&&(d=Math.round(1e3*s/(r-t)),o=Math.min(o,d),l=Math.max(l,d),h.textContent=d+" FPS ("+o+"-"+l+")",b(f,Math.min(30,30-d/100*30)),t=r,s=0),r},update:function(){e=this.end()}}};"object"==typeof module&&(module.exports=Stats);

},{}],42:[function(require,module,exports){
function roundTo(o,n){return"number"==typeof n?Math.round(Math.pow(10,n)*o)/Math.pow(10,n):o}THREE.Console={vector:function(o,n){var t;t=o instanceof THREE.Vector2||o instanceof THREE.Vector3||o instanceof THREE.Vector4?[o]:o,console.table(_.map(t,function(o){return _.map(o.toArray(),function(o){return roundTo(o,n)})}))},matrix:function(o,n){var t,e,r,a,c;for(c=[],e=0,a=o instanceof THREE.Matrix3||o instanceof THREE.Matrix3?o.elements:o,t=0;t<a.length;t++)0===e&&c.push([]),r=roundTo(a[t],n),c[Math.floor(t/4)%4].push(r),e++,e%=4,t%16===15&&(console.table(c),c=[])}},module.exports=THREE.Console;

},{}],43:[function(require,module,exports){
module.exports=function(e){return function(){e.geometry&&e.geometry.dispose(),e.material&&e.material.dispose()}};

},{}],44:[function(require,module,exports){
var random={flip:function(){return Math.random()>.5},range:function(n,r){return Math.random()*(r-n)+n},rangeInt:function(n,r){return Math.floor(this.range(n,r+1))},rangeLow:function(n,r){return Math.random()*Math.random()*(r-n)+n},rangeHigh:function(n,r){return(1-Math.random()*Math.random())*(r-n)+n}};module.exports=random;

},{}],45:[function(require,module,exports){
var selectors=function(e,r,o){var t=$(e);return _.reduce(r,function(e,r,n){if(e[n]=$(r,t),!o&&0===e[n].length)throw new Error("Empty selections are not allowed");return e},{scope:t})};module.exports=selectors;

},{}],46:[function(require,module,exports){
require("./utils/ThreeConsole");var routing=require("./routing"),ui=require("./ui");routing.start(require("./Poem"),require("./levels"));

},{"./Poem":2,"./levels":22,"./routing":29,"./ui":33,"./utils/ThreeConsole":42}],47:[function(require,module,exports){

},{}],48:[function(require,module,exports){
!function(){var e=function(e){function t(e,t){if(e.indexOf)return e.indexOf(t);for(var r=e.length;r--;)if(e[r]===t)return r;return-1}function r(e,r){var n=t(e,r);n!==-1&&e.splice(n,1)}function n(e,t){return"[object "+t+"]"===Object.prototype.toString.call(e)}function i(e){return n(e,"RegExp")}function s(e){return n(e,"Array")}function a(e){return"function"==typeof e}function o(e){var t;return t=null===e||"null"===e?null:"true"===e||"false"!==e&&(e===f||"undefined"===e?f:""===e||isNaN(e)?e:parseFloat(e))}function u(e){for(var t=e.length,r=[];t--;)r[t]=o(e[t]);return r}function h(e,t){for(var r,n,i=(e||"").replace("?","").split("&"),s=i.length,a={};s--;)r=i[s].split("="),n=t?o(r[1]):r[1],a[r[0]]="string"==typeof n?decodeURIComponent(n):n;return a}function p(){this.bypassed=new e.Signal,this.routed=new e.Signal,this._routes=[],this._prevRoutes=[],this._piped=[],this.resetState()}function c(t,r,n,s){var a=i(t),o=s.patternLexer;this._router=s,this._pattern=t,this._paramsIds=a?null:o.getParamIds(t),this._optionalParamsIds=a?null:o.getOptionalParamsIds(t),this._matchRegexp=a?t:o.compilePattern(t,s.ignoreCase),this.matched=new e.Signal,this.switched=new e.Signal,r&&this.matched.add(r),this._priority=n||0}var l,d,f;return d=""===/t(.+)?/.exec("t")[1],p.prototype={greedy:!1,greedyEnabled:!0,ignoreCase:!0,ignoreState:!1,shouldTypecast:!1,normalizeFn:null,resetState:function(){this._prevRoutes.length=0,this._prevMatchedRequest=null,this._prevBypassedRequest=null},create:function(){return new p},addRoute:function(e,t,r){var n=new c(e,t,r,this);return this._sortedInsert(n),n},removeRoute:function(e){r(this._routes,e),e._destroy()},removeAllRoutes:function(){for(var e=this.getNumRoutes();e--;)this._routes[e]._destroy();this._routes.length=0},parse:function(e,t){if(e=e||"",t=t||[],this.ignoreState||e!==this._prevMatchedRequest&&e!==this._prevBypassedRequest){var r,n=this._getMatchedRoutes(e),i=0,s=n.length;if(s)for(this._prevMatchedRequest=e,this._notifyPrevRoutes(n,e),this._prevRoutes=n;i<s;)r=n[i],r.route.matched.dispatch.apply(r.route.matched,t.concat(r.params)),r.isFirst=!i,this.routed.dispatch.apply(this.routed,t.concat([e,r])),i+=1;else this._prevBypassedRequest=e,this.bypassed.dispatch.apply(this.bypassed,t.concat([e]));this._pipeParse(e,t)}},_notifyPrevRoutes:function(e,t){for(var r,n=0;r=this._prevRoutes[n++];)r.route.switched&&this._didSwitch(r.route,e)&&r.route.switched.dispatch(t)},_didSwitch:function(e,t){for(var r,n=0;r=t[n++];)if(r.route===e)return!1;return!0},_pipeParse:function(e,t){for(var r,n=0;r=this._piped[n++];)r.parse(e,t)},getNumRoutes:function(){return this._routes.length},_sortedInsert:function(e){var t=this._routes,r=t.length;do--r;while(t[r]&&e._priority<=t[r]._priority);t.splice(r+1,0,e)},_getMatchedRoutes:function(e){for(var t,r=[],n=this._routes,i=n.length;(t=n[--i])&&((!r.length||this.greedy||t.greedy)&&t.match(e)&&r.push({route:t,params:t._getParamsArray(e)}),this.greedyEnabled||!r.length););return r},pipe:function(e){this._piped.push(e)},unpipe:function(e){r(this._piped,e)},toString:function(){return"[crossroads numRoutes:"+this.getNumRoutes()+"]"}},l=new p,l.VERSION="0.12.0",l.NORM_AS_ARRAY=function(e,t){return[t.vals_]},l.NORM_AS_OBJECT=function(e,t){return[t]},c.prototype={greedy:!1,rules:void 0,match:function(e){return e=e||"",this._matchRegexp.test(e)&&this._validateParams(e)},_validateParams:function(e){var t,r=this.rules,n=this._getParamsObject(e);for(t in r)if("normalize_"!==t&&r.hasOwnProperty(t)&&!this._isValidParam(e,t,n))return!1;return!0},_isValidParam:function(e,r,n){var o=this.rules[r],u=n[r],h=!1,p=0===r.indexOf("?");return null==u&&this._optionalParamsIds&&t(this._optionalParamsIds,r)!==-1?h=!0:i(o)?(p&&(u=n[r+"_"]),h=o.test(u)):s(o)?(p&&(u=n[r+"_"]),h=this._isValidArrayRule(o,u)):a(o)&&(h=o(u,e,n)),h},_isValidArrayRule:function(e,r){if(!this._router.ignoreCase)return t(e,r)!==-1;"string"==typeof r&&(r=r.toLowerCase());for(var n,i,s=e.length;s--;)if(n=e[s],i="string"==typeof n?n.toLowerCase():n,i===r)return!0;return!1},_getParamsObject:function(e){for(var r,n,i=this._router.shouldTypecast,s=this._router.patternLexer.getParamValues(e,this._matchRegexp,i),a={},u=s.length;u--;)n=s[u],this._paramsIds&&(r=this._paramsIds[u],0===r.indexOf("?")&&n&&(a[r+"_"]=n,n=h(n,i),s[u]=n),d&&""===n&&t(this._optionalParamsIds,r)!==-1&&(n=void 0,s[u]=n),a[r]=n),a[u]=n;return a.request_=i?o(e):e,a.vals_=s,a},_getParamsArray:function(e){var t,r=this.rules?this.rules.normalize_:null;return r=r||this._router.normalizeFn,t=r&&a(r)?r(e,this._getParamsObject(e)):this._getParamsObject(e).vals_},interpolate:function(e){var t=this._router.patternLexer.interpolate(this._pattern,e);if(!this._validateParams(t))throw new Error("Generated string doesn't validate against `Route.rules`.");return t},dispose:function(){this._router.removeRoute(this)},_destroy:function(){this.matched.dispose(),this.switched.dispose(),this.matched=this.switched=this._pattern=this._matchRegexp=null},toString:function(){return'[Route pattern:"'+this._pattern+'", numListeners:'+this.matched.getNumListeners()+"]"}},p.prototype.patternLexer=function(){function e(){var e,t;for(e in d)d.hasOwnProperty(e)&&(t=d[e],t.id="__CR_"+e+"__",t.save="save"in t?t.save.replace("{{id}}",t.id):t.id,t.rRestore=new RegExp(t.id,"g"))}function t(e,t){var r,n=[];for(e.lastIndex=0;r=e.exec(t);)n.push(r[1]);return n}function r(e){return t(l,e)}function n(e){return t(d.OP.rgx,e)}function i(e,t){return e=e||"",e&&(v===f?e=e.replace(p,""):v===_&&(e=e.replace(c,"")),e=s(e,"rgx","save"),e=e.replace(h,"\\$&"),e=s(e,"rRestore","res"),v===f&&(e="\\/?"+e)),v!==g&&(e+="\\/?"),new RegExp("^"+e+"$",t?"i":"")}function s(e,t,r){var n,i;for(i in d)d.hasOwnProperty(i)&&(n=d[i],e=e.replace(n[t],n[r]));return e}function a(e,t,r){var n=t.exec(e);return n&&(n.shift(),r&&(n=u(n))),n}function o(e,t){if("string"!=typeof e)throw new Error("Route pattern should be a string.");var r=function(e,r){var n;if(r="?"===r.substr(0,1)?r.substr(1):r,null!=t[r]){if("object"==typeof t[r]){var i=[];for(var s in t[r])i.push(encodeURI(s+"="+t[r][s]));n="?"+i.join("&")}else n=String(t[r]);if(e.indexOf("*")===-1&&n.indexOf("/")!==-1)throw new Error('Invalid value "'+n+'" for segment "'+e+'".')}else{if(e.indexOf("{")!==-1)throw new Error("The segment "+e+" is required.");n=""}return n};return d.OS.trail||(d.OS.trail=new RegExp("(?:"+d.OS.id+")+$")),e.replace(d.OS.rgx,d.OS.save).replace(l,r).replace(d.OS.trail,"").replace(d.OS.rRestore,"/")}var h=/[\\.+*?\^$\[\](){}\/'#]/g,p=/^\/|\/$/g,c=/\/$/g,l=/(?:\{|:)([^}:]+)(?:\}|:)/g,d={OS:{rgx:/([:}]|\w(?=\/))\/?(:|(?:\{\?))/g,save:"$1{{id}}$2",res:"\\/?"},RS:{rgx:/([:}])\/?(\{)/g,save:"$1{{id}}$2",res:"\\/"},RQ:{rgx:/\{\?([^}]+)\}/g,res:"\\?([^#]+)"},OQ:{rgx:/:\?([^:]+):/g,res:"(?:\\?([^#]*))?"},OR:{rgx:/:([^:]+)\*:/g,res:"(.*)?"},RR:{rgx:/\{([^}]+)\*\}/g,res:"(.+)"},RP:{rgx:/\{([^}]+)\}/g,res:"([^\\/?]+)"},OP:{rgx:/:([^:]+):/g,res:"([^\\/?]+)?/?"}},f=1,g=2,_=3,v=f;return e(),{strict:function(){v=g},loose:function(){v=f},legacy:function(){v=_},getParamIds:r,getOptionalParamsIds:n,getParamValues:a,compilePattern:i,interpolate:o}}(),l};"function"==typeof define&&define.amd?define(["signals"],e):"undefined"!=typeof module&&module.exports?module.exports=e(require("signals")):window.crossroads=e(window.signals)}();

},{"signals":49}],49:[function(require,module,exports){
!function(i){function t(i,t,n,e,s){this._listener=t,this._isOnce=n,this.context=e,this._signal=i,this._priority=s||0}function n(i,t){if("function"!=typeof i)throw new Error("listener is a required param of {fn}() and should be a Function.".replace("{fn}",t))}function e(){this._bindings=[],this._prevParams=null;var i=this;this.dispatch=function(){e.prototype.dispatch.apply(i,arguments)}}t.prototype={active:!0,params:null,execute:function(i){var t,n;return this.active&&this._listener&&(n=this.params?this.params.concat(i):i,t=this._listener.apply(this.context,n),this._isOnce&&this.detach()),t},detach:function(){return this.isBound()?this._signal.remove(this._listener,this.context):null},isBound:function(){return!!this._signal&&!!this._listener},isOnce:function(){return this._isOnce},getListener:function(){return this._listener},getSignal:function(){return this._signal},_destroy:function(){delete this._signal,delete this._listener,delete this.context},toString:function(){return"[SignalBinding isOnce:"+this._isOnce+", isBound:"+this.isBound()+", active:"+this.active+"]"}},e.prototype={VERSION:"1.0.0",memorize:!1,_shouldPropagate:!0,active:!0,_registerListener:function(i,n,e,s){var r,o=this._indexOfListener(i,e);if(o!==-1){if(r=this._bindings[o],r.isOnce()!==n)throw new Error("You cannot add"+(n?"":"Once")+"() then add"+(n?"Once":"")+"() the same listener without removing the relationship first.")}else r=new t(this,i,n,e,s),this._addBinding(r);return this.memorize&&this._prevParams&&r.execute(this._prevParams),r},_addBinding:function(i){var t=this._bindings.length;do--t;while(this._bindings[t]&&i._priority<=this._bindings[t]._priority);this._bindings.splice(t+1,0,i)},_indexOfListener:function(i,t){for(var n,e=this._bindings.length;e--;)if(n=this._bindings[e],n._listener===i&&n.context===t)return e;return-1},has:function(i,t){return this._indexOfListener(i,t)!==-1},add:function(i,t,e){return n(i,"add"),this._registerListener(i,!1,t,e)},addOnce:function(i,t,e){return n(i,"addOnce"),this._registerListener(i,!0,t,e)},remove:function(i,t){n(i,"remove");var e=this._indexOfListener(i,t);return e!==-1&&(this._bindings[e]._destroy(),this._bindings.splice(e,1)),i},removeAll:function(){for(var i=this._bindings.length;i--;)this._bindings[i]._destroy();this._bindings.length=0},getNumListeners:function(){return this._bindings.length},halt:function(){this._shouldPropagate=!1},dispatch:function(i){if(this.active){var t,n=Array.prototype.slice.call(arguments),e=this._bindings.length;if(this.memorize&&(this._prevParams=n),e){t=this._bindings.slice(),this._shouldPropagate=!0;do e--;while(t[e]&&this._shouldPropagate&&t[e].execute(n)!==!1)}}},forget:function(){this._prevParams=null},dispose:function(){this.removeAll(),delete this._bindings,delete this._prevParams},toString:function(){return"[Signal active:"+this.active+" numListeners:"+this.getNumListeners()+"]"}};var s=e;s.Signal=e,"function"==typeof define&&define.amd?define(function(){return s}):"undefined"!=typeof module&&module.exports?module.exports=s:i.signals=s}(this);

},{}],50:[function(require,module,exports){
function noop(){throw new Error("You should bundle your code using `glslify` as a transform.")}module.exports=noop;

},{}],51:[function(require,module,exports){
function programify(r,t,e,o){return{vertex:r,fragment:t,uniforms:e,attributes:o}}module.exports=programify;

},{}],52:[function(require,module,exports){
!function(){var e=function(e){var n=function(n){function t(e){return String(e||"").replace(/\W/g,"\\$&")}function a(e){if(!e)return"";var n=new RegExp("^"+t(l.prependHash)+"|"+t(l.appendHash)+"$","g");return e.replace(n,"")}function r(){var e=R.exec(l.getURL()),n=e&&e[1]||"";try{return l.raw?n:decodeURIComponent(n)}catch(e){return n}}function i(){return w?w.contentWindow.frameHash:null}function o(){w=y.createElement("iframe"),w.src="about:blank",w.style.display="none",y.body.appendChild(w)}function c(){if(w&&f!==i()){var e=w.contentWindow.document;e.open(),e.write("<html><head><title>"+y.title+'</title><script type="text/javascript">var frameHash="'+f+'";</script></head><body>&nbsp;</body></html>'),e.close()}}function s(e,n){if(f!==e){var t=f;f=e,x&&(n?w.contentWindow.frameHash=e:c()),l.changed.dispatch(a(e),a(t))}}function p(e,n,t){e.addEventListener?e.addEventListener(n,t,!1):e.attachEvent&&e.attachEvent("on"+n,t)}function d(e,n,t){e.removeEventListener?e.removeEventListener(n,t,!1):e.detachEvent&&e.detachEvent("on"+n,t)}function u(e){e=Array.prototype.slice.call(arguments);var n=e.join(l.separator);return n=n?l.prependHash+n.replace(b,"")+l.appendHash:n}function h(e){return e=encodeURI(e),I&&z&&(e=e.replace(/\?/,"%3F")),e}var l,f,v,g,w,m,H=25,y=n.document,E=(n.history,e.Signal),R=/#(.*)$/,L=/(\?.*)|(\#.*)/,b=/^\#/,I=!1,U="onhashchange"in n&&7!==y.documentMode,x=I&&!U,z="file:"===location.protocol;return m=x?function(){var e=r(),n=i();n!==f&&n!==e?l.setHash(a(n)):e!==f&&s(e)}:function(){var e=r();e!==f&&s(e)},l={VERSION:"1.2.0",raw:!1,appendHash:"",prependHash:"/",separator:"/",changed:new E,stopped:new E,initialized:new E,init:function(){g||(f=r(),U?p(n,"hashchange",m):(x&&(w||o(),c()),v=setInterval(m,H)),g=!0,l.initialized.dispatch(a(f)))},stop:function(){g&&(U?d(n,"hashchange",m):(clearInterval(v),v=null),g=!1,l.stopped.dispatch(a(f)))},isActive:function(){return g},getURL:function(){return n.location.href},getBaseURL:function(){return l.getURL().replace(L,"")},setHash:function(e){e=u.apply(null,arguments),e!==f&&(s(e),e===f&&(l.raw||(e=h(e)),n.location.hash="#"+e))},replaceHash:function(e){e=u.apply(null,arguments),e!==f&&(s(e,!0),e===f&&(l.raw||(e=h(e)),n.location.replace("#"+e)))},getHash:function(){return a(f)},getHashAsArray:function(){return l.getHash().split(l.separator)},dispose:function(){l.stop(),l.initialized.dispose(),l.stopped.dispose(),l.changed.dispose(),w=l=n.hasher=null},toString:function(){return'[hasher version="'+l.VERSION+'" hash="'+l.getHash()+'"]'}},l.initialized.memorize=!0,l}(window);return n};"function"==typeof define&&define.amd?define(["signals"],e):"object"==typeof exports?module.exports=e(require("signals")):window.hasher=e(window.signals)}();

},{"signals":53}],53:[function(require,module,exports){
arguments[4][49][0].apply(exports,arguments)
},{"dup":49}],54:[function(require,module,exports){
"use strict";function Promise(e){function n(e){return null===i?void f.push(e):void asap(function(){var n=i?e.onFulfilled:e.onRejected;if(null===n)return void(i?e.resolve:e.reject)(u);var t;try{t=n(u)}catch(n){return void e.reject(n)}e.resolve(t)})}function t(e){try{if(e===c)throw new TypeError("A promise cannot be resolved with itself.");if(e&&("object"==typeof e||"function"==typeof e)){var n=e.then;if("function"==typeof n)return void doResolve(n.bind(e),t,o)}i=!0,u=e,r()}catch(e){o(e)}}function o(e){i=!1,u=e,r()}function r(){for(var e=0,t=f.length;e<t;e++)n(f[e]);f=null}if("object"!=typeof this)throw new TypeError("Promises must be constructed via new");if("function"!=typeof e)throw new TypeError("not a function");var i=null,u=null,f=[],c=this;this.then=function(e,t){return new Promise(function(o,r){n(new Handler(e,t,o,r))})},doResolve(e,t,o)}function Handler(e,n,t,o){this.onFulfilled="function"==typeof e?e:null,this.onRejected="function"==typeof n?n:null,this.resolve=t,this.reject=o}function doResolve(e,n,t){var o=!1;try{e(function(e){o||(o=!0,n(e))},function(e){o||(o=!0,t(e))})}catch(e){if(o)return;o=!0,t(e)}}var asap=require("asap");module.exports=Promise;

},{"asap":56}],55:[function(require,module,exports){
"use strict";function ValuePromise(e){this.then=function(n){return"function"!=typeof n?this:new Promise(function(r,t){asap(function(){try{r(n(e))}catch(e){t(e)}})})}}var Promise=require("./core.js"),asap=require("asap");module.exports=Promise,ValuePromise.prototype=Object.create(Promise.prototype);var TRUE=new ValuePromise((!0)),FALSE=new ValuePromise((!1)),NULL=new ValuePromise(null),UNDEFINED=new ValuePromise((void 0)),ZERO=new ValuePromise(0),EMPTYSTRING=new ValuePromise("");Promise.resolve=function(e){if(e instanceof Promise)return e;if(null===e)return NULL;if(void 0===e)return UNDEFINED;if(e===!0)return TRUE;if(e===!1)return FALSE;if(0===e)return ZERO;if(""===e)return EMPTYSTRING;if("object"==typeof e||"function"==typeof e)try{var n=e.then;if("function"==typeof n)return new Promise(n.bind(e))}catch(e){return new Promise(function(n,r){r(e)})}return new ValuePromise(e)},Promise.from=Promise.cast=function(e){var n=new Error("Promise.from and Promise.cast are deprecated, use Promise.resolve instead");return n.name="Warning",console.warn(n.stack),Promise.resolve(e)},Promise.denodeify=function(e,n){return n=n||1/0,function(){var r=this,t=Array.prototype.slice.call(arguments);return new Promise(function(o,i){for(;t.length&&t.length>n;)t.pop();t.push(function(e,n){e?i(e):o(n)}),e.apply(r,t)})}},Promise.nodeify=function(e){return function(){var n=Array.prototype.slice.call(arguments),r="function"==typeof n[n.length-1]?n.pop():null;try{return e.apply(this,arguments).nodeify(r)}catch(e){if(null===r||"undefined"==typeof r)return new Promise(function(n,r){r(e)});asap(function(){r(e)})}}},Promise.all=function(){var e=1===arguments.length&&Array.isArray(arguments[0]),n=Array.prototype.slice.call(e?arguments[0]:arguments);if(!e){var r=new Error("Promise.all should be called with a single array, calling it with multiple arguments is deprecated");r.name="Warning",console.warn(r.stack)}return new Promise(function(e,r){function t(i,u){try{if(u&&("object"==typeof u||"function"==typeof u)){var s=u.then;if("function"==typeof s)return void s.call(u,function(e){t(i,e)},r)}n[i]=u,0===--o&&e(n)}catch(e){r(e)}}if(0===n.length)return e([]);for(var o=n.length,i=0;i<n.length;i++)t(i,n[i])})},Promise.reject=function(e){return new Promise(function(n,r){r(e)})},Promise.race=function(e){return new Promise(function(n,r){e.forEach(function(e){Promise.resolve(e).then(n,r)})})},Promise.prototype.done=function(e,n){var r=arguments.length?this.then.apply(this,arguments):this;r.then(null,function(e){asap(function(){throw e})})},Promise.prototype.nodeify=function(e){return"function"!=typeof e?this:void this.then(function(n){asap(function(){e(null,n)})},function(n){asap(function(){e(n)})})},Promise.prototype.catch=function(e){return this.then(null,e)};

},{"./core.js":54,"asap":56}],56:[function(require,module,exports){
(function (process){
function flush(){for(;head.next;){head=head.next;var e=head.task;head.task=void 0;var s=head.domain;s&&(head.domain=void 0,s.enter());try{e()}catch(e){if(isNodeJS)throw s&&s.exit(),setTimeout(flush,0),s&&s.enter(),e;setTimeout(function(){throw e},0)}s&&s.exit()}flushing=!1}function asap(e){tail=tail.next={task:e,domain:isNodeJS&&process.domain,next:null},flushing||(flushing=!0,requestFlush())}var head={task:void 0,next:null},tail=head,flushing=!1,requestFlush=void 0,isNodeJS=!1;if("undefined"!=typeof process&&process.nextTick)isNodeJS=!0,requestFlush=function(){process.nextTick(flush)};else if("function"==typeof setImmediate)requestFlush="undefined"!=typeof window?setImmediate.bind(window,flush):function(){setImmediate(flush)};else if("undefined"!=typeof MessageChannel){var channel=new MessageChannel;channel.port1.onmessage=flush,requestFlush=function(){channel.port2.postMessage(0)}}else requestFlush=function(){setTimeout(flush,0)};module.exports=asap;

}).call(this,require('_process'))

},{"_process":61}],57:[function(require,module,exports){
(function(){"use strict";function n(n){var e=this,r={db:null};if(n)for(var t in n)r[t]=n[t];return new v(function(n,t){var o=l.open(r.name,r.version);o.onerror=function(){t(o.error)},o.onupgradeneeded=function(){o.result.createObjectStore(r.storeName)},o.onsuccess=function(){r.db=o.result,e._dbInfo=r,n()}})}function e(n,e){var r=this;"string"!=typeof n&&(window.console.warn(n+" used as a key, but it is not a string."),n=String(n));var t=new v(function(e,t){r.ready().then(function(){var o=r._dbInfo,i=o.db.transaction(o.storeName,"readonly").objectStore(o.storeName),c=i.get(n);c.onsuccess=function(){var n=c.result;void 0===n&&(n=null),e(n)},c.onerror=function(){t(c.error)}}).catch(t)});return d(t,e),t}function r(n,e){var r=this,t=new v(function(e,t){r.ready().then(function(){var o=r._dbInfo,i=o.db.transaction(o.storeName,"readonly").objectStore(o.storeName),c=i.openCursor();c.onsuccess=function(){var r=c.result;if(r){var t=n(r.value,r.key);void 0!==t?e(t):r.continue()}else e()},c.onerror=function(){t(c.error)}}).catch(t)});return d(t,e),t}function t(n,e,r){var t=this;"string"!=typeof n&&(window.console.warn(n+" used as a key, but it is not a string."),n=String(n));var o=new v(function(r,o){t.ready().then(function(){var i=t._dbInfo,c=i.db.transaction(i.storeName,"readwrite").objectStore(i.storeName);null===e&&(e=void 0);var u=c.put(e,n);u.onsuccess=function(){void 0===e&&(e=null),r(e)},u.onerror=function(){o(u.error)}}).catch(o)});return d(o,r),o}function o(n,e){var r=this;"string"!=typeof n&&(window.console.warn(n+" used as a key, but it is not a string."),n=String(n));var t=new v(function(e,t){r.ready().then(function(){var o=r._dbInfo,i=o.db.transaction(o.storeName,"readwrite").objectStore(o.storeName),c=i.delete(n);c.onsuccess=function(){e()},c.onerror=function(){t(c.error)},c.onabort=function(n){var e=n.target.error;"QuotaExceededError"===e&&t(e)}}).catch(t)});return d(t,e),t}function i(n){var e=this,r=new v(function(n,r){e.ready().then(function(){var t=e._dbInfo,o=t.db.transaction(t.storeName,"readwrite").objectStore(t.storeName),i=o.clear();i.onsuccess=function(){n()},i.onerror=function(){r(i.error)}}).catch(r)});return d(r,n),r}function c(n){var e=this,r=new v(function(n,r){e.ready().then(function(){var t=e._dbInfo,o=t.db.transaction(t.storeName,"readonly").objectStore(t.storeName),i=o.count();i.onsuccess=function(){n(i.result)},i.onerror=function(){r(i.error)}}).catch(r)});return s(r,n),r}function u(n,e){var r=this,t=new v(function(e,t){return n<0?void e(null):void r.ready().then(function(){var o=r._dbInfo,i=o.db.transaction(o.storeName,"readonly").objectStore(o.storeName),c=!1,u=i.openCursor();u.onsuccess=function(){var r=u.result;return r?void(0===n?e(r.key):c?e(r.key):(c=!0,r.advance(n))):void e(null)},u.onerror=function(){t(u.error)}}).catch(t)});return s(t,e),t}function a(n){var e=this,r=new v(function(n,r){e.ready().then(function(){var t=e._dbInfo,o=t.db.transaction(t.storeName,"readonly").objectStore(t.storeName),i=o.openCursor(),c=[];i.onsuccess=function(){var e=i.result;return e?(c.push(e.key),void e.continue()):void n(c)},i.onerror=function(){r(i.error)}}).catch(r)});return s(r,n),r}function s(n,e){e&&n.then(function(n){e(null,n)},function(n){e(n)})}function d(n,e){e&&n.then(function(n){f(e,n)},function(n){e(n)})}function f(n,e){if(n)return setTimeout(function(){return n(null,e)},0)}var v="undefined"!=typeof module&&module.exports?require("promise"):this.Promise,l=l||this.indexedDB||this.webkitIndexedDB||this.mozIndexedDB||this.OIndexedDB||this.msIndexedDB;if(l){var h={_driver:"asyncStorage",_initStorage:n,iterate:r,getItem:e,setItem:t,removeItem:o,clear:i,length:c,key:u,keys:a};"function"==typeof define&&define.amd?define("asyncStorage",function(){return h}):"undefined"!=typeof module&&module.exports?module.exports=h:this.asyncStorage=h}}).call(window);

},{"promise":55}],58:[function(require,module,exports){
(function(){"use strict";function r(r){var e=this,t={};if(r)for(var n in r)t[n]=r[n];return t.keyPrefix=t.name+"/",e._dbInfo=t,h.resolve()}function e(r){var e=this,t=new h(function(r,t){e.ready().then(function(){for(var t=e._dbInfo.keyPrefix,n=d.length-1;n>=0;n--){var a=d.key(n);0===a.indexOf(t)&&d.removeItem(a)}r()}).catch(t)});return y(t,r),t}function t(r,e){var t=this;"string"!=typeof r&&(window.console.warn(r+" used as a key, but it is not a string."),r=String(r));var n=new h(function(e,n){t.ready().then(function(){try{var a=t._dbInfo,o=d.getItem(a.keyPrefix+r);o&&(o=u(o)),e(o)}catch(r){n(r)}}).catch(n)});return y(n,e),n}function n(r,e){var t=this,n=new h(function(e,n){t.ready().then(function(){try{for(var a=t._dbInfo.keyPrefix,o=a.length,i=d.length,c=0;c<i;c++){var f=d.key(c),s=d.getItem(f);if(s&&(s=u(s)),s=r(s,f.substring(o)),void 0!==s)return void e(s)}e()}catch(r){n(r)}}).catch(n)});return y(n,e),n}function a(r,e){var t=this,n=new h(function(e,n){t.ready().then(function(){var n,a=t._dbInfo;try{n=d.key(r)}catch(r){n=null}n&&(n=n.substring(a.keyPrefix.length)),e(n)}).catch(n)});return y(n,e),n}function o(r){var e=this,t=new h(function(r,t){e.ready().then(function(){for(var t=e._dbInfo,n=d.length,a=[],o=0;o<n;o++)0===d.key(o).indexOf(t.keyPrefix)&&a.push(d.key(o).substring(t.keyPrefix.length));r(a)}).catch(t)});return y(t,r),t}function i(r){var e=this,t=new h(function(r,t){e.keys().then(function(e){r(e.length)}).catch(t)});return y(t,r),t}function c(r,e){var t=this;"string"!=typeof r&&(window.console.warn(r+" used as a key, but it is not a string."),r=String(r));var n=new h(function(e,n){t.ready().then(function(){var n=t._dbInfo;d.removeItem(n.keyPrefix+r),e()}).catch(n)});return y(n,e),n}function u(r){if(r.substring(0,v)!==g)return JSON.parse(r);for(var e=r.substring(U),t=r.substring(v,U),n=new ArrayBuffer(2*e.length),a=new Uint16Array(n),o=e.length-1;o>=0;o--)a[o]=e.charCodeAt(o);switch(t){case w:return n;case b:return new Blob([n]);case A:return new Int8Array(n);case m:return new Uint8Array(n);case p:return new Uint8ClampedArray(n);case I:return new Int16Array(n);case S:return new Uint16Array(n);case k:return new Int32Array(n);case _:return new Uint32Array(n);case x:return new Float32Array(n);case j:return new Float64Array(n);default:throw new Error("Unkown type: "+t)}}function f(r){var e="",t=new Uint16Array(r);try{e=String.fromCharCode.apply(null,t)}catch(r){for(var n=0;n<t.length;n++)e+=String.fromCharCode(t[n])}return e}function s(r,e){var t="";if(r&&(t=r.toString()),r&&("[object ArrayBuffer]"===r.toString()||r.buffer&&"[object ArrayBuffer]"===r.buffer.toString())){var n,a=g;r instanceof ArrayBuffer?(n=r,a+=w):(n=r.buffer,"[object Int8Array]"===t?a+=A:"[object Uint8Array]"===t?a+=m:"[object Uint8ClampedArray]"===t?a+=p:"[object Int16Array]"===t?a+=I:"[object Uint16Array]"===t?a+=S:"[object Int32Array]"===t?a+=k:"[object Uint32Array]"===t?a+=_:"[object Float32Array]"===t?a+=x:"[object Float64Array]"===t?a+=j:e(new Error("Failed to get type for BinaryArray"))),e(a+f(n))}else if("[object Blob]"===t){var o=new FileReader;o.onload=function(){var r=f(this.result);e(g+b+r)},o.readAsArrayBuffer(r)}else try{e(JSON.stringify(r))}catch(t){window.console.error("Couldn't convert value into a JSON string: ",r),e(t)}}function l(r,e,t){var n=this;"string"!=typeof r&&(window.console.warn(r+" used as a key, but it is not a string."),r=String(r));var a=new h(function(t,a){n.ready().then(function(){void 0===e&&(e=null);var o=e;s(e,function(e,i){if(i)a(i);else{try{var c=n._dbInfo;d.setItem(c.keyPrefix+r,e)}catch(r){"QuotaExceededError"!==r.name&&"NS_ERROR_DOM_QUOTA_REACHED"!==r.name||a(r)}t(o)}})}).catch(a)});return y(a,t),a}function y(r,e){e&&r.then(function(r){e(null,r)},function(r){e(r)})}var h="undefined"!=typeof module&&module.exports?require("promise"):this.Promise,d=null;try{if(!(this.localStorage&&"setItem"in this.localStorage))return;d=this.localStorage}catch(r){return}var g="__lfsc__:",v=g.length,w="arbf",b="blob",A="si08",m="ui08",p="uic8",I="si16",k="si32",S="ur16",_="ui32",x="fl32",j="fl64",U=v+w.length,P={_driver:"localStorageWrapper",_initStorage:r,iterate:n,getItem:t,setItem:l,removeItem:c,clear:e,length:i,key:a,keys:o};"function"==typeof define&&define.amd?define("localStorageWrapper",function(){return P}):"undefined"!=typeof module&&module.exports?module.exports=P:this.localStorageWrapper=P}).call(window);

},{"promise":55}],59:[function(require,module,exports){
(function(){"use strict";function n(n){var t=this,e={db:null};if(n)for(var r in n)e[r]="string"!=typeof n[r]?n[r].toString():n[r];return new h(function(r,o){try{e.db=b(e.name,String(e.version),e.description,e.size)}catch(e){return t.setDriver("localStorageWrapper").then(function(){return t._initStorage(n)}).then(r).catch(o)}e.db.transaction(function(n){n.executeSql("CREATE TABLE IF NOT EXISTS "+e.storeName+" (id INTEGER PRIMARY KEY, key unique, value)",[],function(){t._dbInfo=e,r()},function(n,t){o(t)})})})}function t(n,t){var e=this;"string"!=typeof n&&(window.console.warn(n+" used as a key, but it is not a string."),n=String(n));var r=new h(function(t,r){e.ready().then(function(){var o=e._dbInfo;o.db.transaction(function(e){e.executeSql("SELECT * FROM "+o.storeName+" WHERE key = ? LIMIT 1",[n],function(n,e){var r=e.rows.length?e.rows.item(0).value:null;r&&(r=s(r)),t(r)},function(n,t){r(t)})})}).catch(r)});return d(r,t),r}function e(n,t){var e=this,r=new h(function(t,r){e.ready().then(function(){var o=e._dbInfo;o.db.transaction(function(e){e.executeSql("SELECT * FROM "+o.storeName,[],function(e,r){for(var o=r.rows,i=o.length,a=0;a<i;a++){var u=o.item(a),c=u.value;if(c&&(c=s(c)),c=n(c,u.key),void 0!==c)return void t(c)}t()},function(n,t){r(t)})})}).catch(r)});return d(r,t),r}function r(n,t,e){var r=this;"string"!=typeof n&&(window.console.warn(n+" used as a key, but it is not a string."),n=String(n));var o=new h(function(e,o){r.ready().then(function(){void 0===t&&(t=null);var i=t;l(t,function(t,a){if(a)o(a);else{var u=r._dbInfo;u.db.transaction(function(r){r.executeSql("INSERT OR REPLACE INTO "+u.storeName+" (key, value) VALUES (?, ?)",[n,t],function(){e(i)},function(n,t){o(t)})},function(n){n.code===n.QUOTA_ERR&&o(n)})}})}).catch(o)});return d(o,e),o}function o(n,t){var e=this;"string"!=typeof n&&(window.console.warn(n+" used as a key, but it is not a string."),n=String(n));var r=new h(function(t,r){e.ready().then(function(){var o=e._dbInfo;o.db.transaction(function(e){e.executeSql("DELETE FROM "+o.storeName+" WHERE key = ?",[n],function(){t()},function(n,t){r(t)})})}).catch(r)});return d(r,t),r}function i(n){var t=this,e=new h(function(n,e){t.ready().then(function(){var r=t._dbInfo;r.db.transaction(function(t){t.executeSql("DELETE FROM "+r.storeName,[],function(){n()},function(n,t){e(t)})})}).catch(e)});return d(e,n),e}function a(n){var t=this,e=new h(function(n,e){t.ready().then(function(){var r=t._dbInfo;r.db.transaction(function(t){t.executeSql("SELECT COUNT(key) as c FROM "+r.storeName,[],function(t,e){var r=e.rows.item(0).c;n(r)},function(n,t){e(t)})})}).catch(e)});return d(e,n),e}function u(n,t){var e=this,r=new h(function(t,r){e.ready().then(function(){var o=e._dbInfo;o.db.transaction(function(e){e.executeSql("SELECT key FROM "+o.storeName+" WHERE id = ? LIMIT 1",[n+1],function(n,e){var r=e.rows.length?e.rows.item(0).key:null;t(r)},function(n,t){r(t)})})}).catch(r)});return d(r,t),r}function c(n){var t=this,e=new h(function(n,e){t.ready().then(function(){var r=t._dbInfo;r.db.transaction(function(t){t.executeSql("SELECT key FROM "+r.storeName,[],function(t,e){for(var r=[],o=0;o<e.rows.length;o++)r.push(e.rows.item(o).key);n(r)},function(n,t){e(t)})})}).catch(e)});return d(e,n),e}function f(n){var t,e=new Uint8Array(n),r="";for(t=0;t<e.length;t+=3)r+=y[e[t]>>2],r+=y[(3&e[t])<<4|e[t+1]>>4],r+=y[(15&e[t+1])<<2|e[t+2]>>6],r+=y[63&e[t+2]];return e.length%3===2?r=r.substring(0,r.length-1)+"=":e.length%3===1&&(r=r.substring(0,r.length-2)+"=="),r}function s(n){if(n.substring(0,v)!==w)return JSON.parse(n);var t,e,r,o,i,a=n.substring(k),u=n.substring(v,k),c=.75*a.length,f=a.length,s=0;"="===a[a.length-1]&&(c--,"="===a[a.length-2]&&c--);var l=new ArrayBuffer(c),d=new Uint8Array(l);for(t=0;t<f;t+=4)e=y.indexOf(a[t]),r=y.indexOf(a[t+1]),o=y.indexOf(a[t+2]),i=y.indexOf(a[t+3]),d[s++]=e<<2|r>>4,d[s++]=(15&r)<<4|o>>2,d[s++]=(3&o)<<6|63&i;switch(u){case g:return l;case S:return new Blob([l]);case E:return new Int8Array(l);case A:return new Uint8Array(l);case m:return new Uint8ClampedArray(l);case I:return new Int16Array(l);case R:return new Uint16Array(l);case p:return new Int32Array(l);case O:return new Uint32Array(l);case T:return new Float32Array(l);case N:return new Float64Array(l);default:throw new Error("Unkown type: "+u)}}function l(n,t){var e="";if(n&&(e=n.toString()),n&&("[object ArrayBuffer]"===n.toString()||n.buffer&&"[object ArrayBuffer]"===n.buffer.toString())){var r,o=w;n instanceof ArrayBuffer?(r=n,o+=g):(r=n.buffer,"[object Int8Array]"===e?o+=E:"[object Uint8Array]"===e?o+=A:"[object Uint8ClampedArray]"===e?o+=m:"[object Int16Array]"===e?o+=I:"[object Uint16Array]"===e?o+=R:"[object Int32Array]"===e?o+=p:"[object Uint32Array]"===e?o+=O:"[object Float32Array]"===e?o+=T:"[object Float64Array]"===e?o+=N:t(new Error("Failed to get type for BinaryArray"))),t(o+f(r))}else if("[object Blob]"===e){var i=new FileReader;i.onload=function(){var n=f(this.result);t(w+S+n)},i.readAsArrayBuffer(n)}else try{t(JSON.stringify(n))}catch(e){window.console.error("Couldn't convert value into a JSON string: ",n),t(null,e)}}function d(n,t){t&&n.then(function(n){t(null,n)},function(n){t(n)})}var y="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",h="undefined"!=typeof module&&module.exports?require("promise"):this.Promise,b=this.openDatabase,w="__lfsc__:",v=w.length,g="arbf",S="blob",E="si08",A="ui08",m="uic8",I="si16",p="si32",R="ur16",O="ui32",T="fl32",N="fl64",k=v+g.length;if(b){var x={_driver:"webSQLStorage",_initStorage:n,iterate:e,getItem:t,setItem:r,removeItem:o,clear:i,length:a,key:u,keys:c};"function"==typeof define&&define.amd?define("webSQLStorage",function(){return x}):"undefined"!=typeof module&&module.exports?module.exports=x:this.webSQLStorage=x}}).call(window);

},{"promise":55}],60:[function(require,module,exports){
(function(){"use strict";function e(e,r){e[r]=function(){var t=arguments;return e.ready().then(function(){return e[r].apply(e,t)})}}function r(){for(var e=1;e<arguments.length;e++){var r=arguments[e];if(r)for(var t in r)r.hasOwnProperty(t)&&(v(r[t])?arguments[0][t]=r[t].slice():arguments[0][t]=r[t])}return arguments[0]}function t(e){for(var r in a)if(a.hasOwnProperty(r)&&a[r]===e)return!0;return!1}function n(t){this._config=r({},d,t),this._driverSet=null,this._ready=!1,this._dbInfo=null;for(var n=0;n<s.length;n++)e(this,s[n]);this.setDriver(this._config.driver)}var i="undefined"!=typeof module&&module.exports?require("promise"):this.Promise,o={},a={INDEXEDDB:"asyncStorage",LOCALSTORAGE:"localStorageWrapper",WEBSQL:"webSQLStorage"},u=[a.INDEXEDDB,a.WEBSQL,a.LOCALSTORAGE],s=["clear","getItem","iterate","key","keys","length","removeItem","setItem"],f={DEFINE:1,EXPORT:2,WINDOW:3},d={description:"",driver:u.slice(),name:"localforage",size:4980736,storeName:"keyvaluepairs",version:1},c=f.WINDOW;"function"==typeof define&&define.amd?c=f.DEFINE:"undefined"!=typeof module&&module.exports&&(c=f.EXPORT);var p=function(e){var r=r||e.indexedDB||e.webkitIndexedDB||e.mozIndexedDB||e.OIndexedDB||e.msIndexedDB,t={};return t[a.WEBSQL]=!!e.openDatabase,t[a.INDEXEDDB]=!!function(){if("undefined"!=typeof e.openDatabase&&e.navigator&&e.navigator.userAgent&&/Safari/.test(e.navigator.userAgent)&&!/Chrome/.test(e.navigator.userAgent))return!1;try{return r&&"function"==typeof r.open&&"undefined"!=typeof e.IDBKeyRange}catch(e){return!1}}(),t[a.LOCALSTORAGE]=!!function(){try{return e.localStorage&&"setItem"in e.localStorage&&e.localStorage.setItem}catch(e){return!1}}(),t}(this),v=Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)},l=this;n.prototype.INDEXEDDB=a.INDEXEDDB,n.prototype.LOCALSTORAGE=a.LOCALSTORAGE,n.prototype.WEBSQL=a.WEBSQL,n.prototype.config=function(e){if("object"==typeof e){if(this._ready)return new Error("Can't call config() after localforage has been used.");for(var r in e)"storeName"===r&&(e[r]=e[r].replace(/\W/g,"_")),this._config[r]=e[r];return"driver"in e&&e.driver&&this.setDriver(this._config.driver),!0}return"string"==typeof e?this._config[e]:this._config},n.prototype.defineDriver=function(e,r,n){var a=new i(function(r,n){try{var a=e._driver,u=new Error("Custom driver not compliant; see https://mozilla.github.io/localForage/#definedriver"),f=new Error("Custom driver name already in use: "+e._driver);if(!e._driver)return void n(u);if(t(e._driver))return void n(f);for(var d=s.concat("_initStorage"),c=0;c<d.length;c++){var v=d[c];if(!v||!e[v]||"function"!=typeof e[v])return void n(u)}var l=i.resolve(!0);"_support"in e&&(l=e._support&&"function"==typeof e._support?e._support():i.resolve(!!e._support)),l.then(function(t){p[a]=t,o[a]=e,r()},n)}catch(e){n(e)}});return a.then(r,n),a},n.prototype.driver=function(){return this._driver||null},n.prototype.ready=function(e){var r=this,t=new i(function(e,t){r._driverSet.then(function(){null===r._ready&&(r._ready=r._initStorage(r._config)),r._ready.then(e,t)}).catch(t)});return t.then(e,e),t},n.prototype.setDriver=function(e,r,n){function a(){u._config.driver=u.driver()}var u=this;return"string"==typeof e&&(e=[e]),this._driverSet=new i(function(r,n){var a=u._getFirstSupportedDriver(e),s=new Error("No available storage method found.");if(!a)return u._driverSet=i.reject(s),void n(s);if(u._dbInfo=null,u._ready=null,t(a)){if(c===f.DEFINE)return void require([a],function(e){u._extend(e),r()});if(c===f.EXPORT){var d;switch(a){case u.INDEXEDDB:d=require("./drivers/indexeddb");break;case u.LOCALSTORAGE:d=require("./drivers/localstorage");break;case u.WEBSQL:d=require("./drivers/websql")}u._extend(d)}else u._extend(l[a])}else{if(!o[a])return u._driverSet=i.reject(s),void n(s);u._extend(o[a])}r()}),this._driverSet.then(a,a),this._driverSet.then(r,n),this._driverSet},n.prototype.supports=function(e){return!!p[e]},n.prototype._extend=function(e){r(this,e)},n.prototype._getFirstSupportedDriver=function(e){if(e&&v(e))for(var r=0;r<e.length;r++){var t=e[r];if(this.supports(t))return t}return null},n.prototype.createInstance=function(e){return new n(e)};var h=new n;c===f.DEFINE?define("localforage",function(){return h}):c===f.EXPORT?module.exports=h:this.localforage=h}).call(window);

},{"./drivers/indexeddb":57,"./drivers/localstorage":58,"./drivers/websql":59,"promise":55}],61:[function(require,module,exports){
function cleanUpNextTick(){draining&&currentQueue&&(draining=!1,currentQueue.length?queue=currentQueue.concat(queue):queueIndex=-1,queue.length&&drainQueue())}function drainQueue(){if(!draining){var e=cachedSetTimeout(cleanUpNextTick);draining=!0;for(var r=queue.length;r;){for(currentQueue=queue,queue=[];++queueIndex<r;)currentQueue&&currentQueue[queueIndex].run();queueIndex=-1,r=queue.length}currentQueue=null,draining=!1,cachedClearTimeout(e)}}function Item(e,r){this.fun=e,this.array=r}function noop(){}var process=module.exports={},cachedSetTimeout,cachedClearTimeout;!function(){try{cachedSetTimeout=setTimeout}catch(e){cachedSetTimeout=function(){throw new Error("setTimeout is not defined")}}try{cachedClearTimeout=clearTimeout}catch(e){cachedClearTimeout=function(){throw new Error("clearTimeout is not defined")}}}();var queue=[],draining=!1,currentQueue,queueIndex=-1;process.nextTick=function(e){var r=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)r[n-1]=arguments[n];queue.push(new Item(e,r)),1!==queue.length||draining||cachedSetTimeout(drainQueue,0)},Item.prototype.run=function(){this.fun.apply(null,this.array)},process.title="browser",process.browser=!0,process.env={},process.argv=[],process.version="",process.versions={},process.on=noop,process.addListener=noop,process.once=noop,process.off=noop,process.removeListener=noop,process.removeAllListeners=noop,process.emit=noop,process.binding=function(e){throw new Error("process.binding is not supported")},process.cwd=function(){return"/"},process.chdir=function(e){throw new Error("process.chdir is not supported")},process.umask=function(){return 0};

},{}],62:[function(require,module,exports){
"use strict";function hasOwnProperty(r,e){return Object.prototype.hasOwnProperty.call(r,e)}module.exports=function(r,e,t,n){e=e||"&",t=t||"=";var o={};if("string"!=typeof r||0===r.length)return o;var a=/\+/g;r=r.split(e);var s=1e3;n&&"number"==typeof n.maxKeys&&(s=n.maxKeys);var p=r.length;s>0&&p>s&&(p=s);for(var y=0;y<p;++y){var u,c,i,l,f=r[y].replace(a,"%20"),v=f.indexOf(t);v>=0?(u=f.substr(0,v),c=f.substr(v+1)):(u=f,c=""),i=decodeURIComponent(u),l=decodeURIComponent(c),hasOwnProperty(o,i)?isArray(o[i])?o[i].push(l):o[i]=[o[i],l]:o[i]=l}return o};var isArray=Array.isArray||function(r){return"[object Array]"===Object.prototype.toString.call(r)};

},{}],63:[function(require,module,exports){
"use strict";function map(r,e){if(r.map)return r.map(e);for(var t=[],n=0;n<r.length;n++)t.push(e(r[n],n));return t}var stringifyPrimitive=function(r){switch(typeof r){case"string":return r;case"boolean":return r?"true":"false";case"number":return isFinite(r)?r:"";default:return""}};module.exports=function(r,e,t,n){return e=e||"&",t=t||"=",null===r&&(r=void 0),"object"==typeof r?map(objectKeys(r),function(n){var i=encodeURIComponent(stringifyPrimitive(n))+t;return isArray(r[n])?map(r[n],function(r){return i+encodeURIComponent(stringifyPrimitive(r))}).join(e):i+encodeURIComponent(stringifyPrimitive(r[n]))}).join(e):n?encodeURIComponent(stringifyPrimitive(n))+t+encodeURIComponent(stringifyPrimitive(r)):""};var isArray=Array.isArray||function(r){return"[object Array]"===Object.prototype.toString.call(r)},objectKeys=Object.keys||function(r){var e=[];for(var t in r)Object.prototype.hasOwnProperty.call(r,t)&&e.push(t);return e};

},{}],64:[function(require,module,exports){
"use strict";exports.decode=exports.parse=require("./decode"),exports.encode=exports.stringify=require("./encode");

},{"./decode":62,"./encode":63}],65:[function(require,module,exports){
function noop(n){if(n)throw n}function badge(n,t){inserted||(insert(".npm-scb-wrap {\n  font-family: 'Open Sans', 'Helvetica Neue', Helvetica, Arial, sans-serif;\n  font-weight: 200;\n  position: absolute;\n  top: 0;\n  left: 0;\n  z-index: 999;\n}\n\n.npm-scb-wrap a {\n  text-decoration: none;\n  color: #000;\n}\n.npm-scb-white\n.npm-scb-wrap a {\n  color: #fff;\n}\n\n.npm-scb-inner {\n  position: absolute;\n  top: -120px; left: 0;\n  padding: 8px;\n  width: 100%;\n  height: 150px;\n  z-index: 2;\n  -webkit-transition: width 0.5s cubic-bezier(1, 0, 0, 1), top 0.5s;\n     -moz-transition: width 0.5s cubic-bezier(1, 0, 0, 1), top 0.5s;\n      -ms-transition: width 0.5s cubic-bezier(1, 0, 0, 1), top 0.5s;\n       -o-transition: width 0.5s cubic-bezier(1, 0, 0, 1), top 0.5s;\n          transition: width 0.5s cubic-bezier(1, 0, 0, 1), top 0.5s;\n}\n.npm-scb-wrap:hover\n.npm-scb-inner {\n  top: 0;\n}\n\n.npm-scb-artwork {\n  position: absolute;\n  top: 16px; left: 16px;\n  width: 104px; height: 104px;\n  box-shadow: 0 0 8px -3px #000;\n  outline: 1px solid rgba(0,0,0,0.1);\n  z-index: 2;\n}\n.npm-scb-white\n.npm-scb-artwork {\n  outline: 1px solid rgba(255,255,255,0.1);\n  box-shadow: 0 0 10px -2px rgba(255,255,255,0.9);\n}\n\n.npm-scb-info {\n  position: absolute;\n  top: 16px;\n  left: 120px;\n  width: 300px;\n  z-index: 1;\n}\n\n.npm-scb-info > a {\n  display: block;\n}\n\n.npm-scb-now-playing {\n  font-size: 12px;\n  line-height: 12px;\n  position: absolute;\n  width: 500px;\n  z-index: 1;\n  padding: 15px 0;\n  top: 0; left: 138px;\n  opacity: 1;\n  -webkit-transition: opacity 0.25s;\n     -moz-transition: opacity 0.25s;\n      -ms-transition: opacity 0.25s;\n       -o-transition: opacity 0.25s;\n          transition: opacity 0.25s;\n}\n\n.npm-scb-wrap:hover\n.npm-scb-now-playing {\n  opacity: 0;\n}\n\n.npm-scb-white\n.npm-scb-now-playing {\n  color: #fff;\n}\n.npm-scb-now-playing > a {\n  font-weight: bold;\n}\n\n.npm-scb-info > a > p {\n  margin: 0;\n  padding-bottom: 0.25em;\n  line-height: 1.35em;\n  margin-left: 1em;\n  font-size: 1em;\n}\n\n.npm-scb-title {\n  font-weight: bold;\n}\n\n.npm-scb-icon {\n  position: absolute;\n  top: 120px;\n  padding-top: 0.75em;\n  left: 16px;\n}\n"),inserted=!0),template||(template=minstache.compile('<div class="npm-scb-wrap">\n  <div class="npm-scb-inner">\n    <a target="_blank" href="{{urls.song}}">\n      <img class="npm-scb-icon" src="{{icon}}">\n      <img class="npm-scb-artwork" src="{{artwork}}">\n    </a>\n    <div class="npm-scb-info">\n      <a target="_blank" href="{{urls.song}}">\n        <p class="npm-scb-title">{{title}}</p>\n      </a>\n      <a target="_blank" href="{{urls.artist}}">\n        <p class="npm-scb-artist">{{artist}}</p>\n      </a>\n    </div>\n  </div>\n  <div class="npm-scb-now-playing">\n    Now Playing:\n    <a href="{{urls.song}}">{{title}}</a>\n    by\n    <a href="{{urls.artist}}">{{artist}}</a>\n  </div>\n</div>\n')),!gwfadded&&n.getFonts&&(fonts.add({"Open Sans":[300,600]}),gwfadded=!0),n=n||{},t=t||noop;var i=n.el||document.createElement("div"),e="dark"in n&&!n.dark?"white":"black",s=n.client_id,o=n.song;return resolve(s,o,function(n,o){if(n)return t(n);if("track"!==o.kind)throw new Error("soundcloud-badge only supports individual tracks at the moment");i.classList["black"===e?"remove":"add"]("npm-scb-white"),i.innerHTML=template({artwork:o.artwork_url||o.user.avatar_url,artist:o.user.username,title:o.title,icon:icons[e],urls:{song:o.permalink_url,artist:o.user.permalink_url}}),document.body.appendChild(i),t(null,o.stream_url+"?client_id="+s,o,i)}),i}var resolve=require("soundcloud-resolve"),fonts=require("google-fonts"),minstache=require("minstache"),insert=require("insert-css"),fs=require("fs"),icons={black:"http://developers.soundcloud.com/assets/logo_black.png",white:"http://developers.soundcloud.com/assets/logo_white.png"};module.exports=badge;var inserted=!1,gwfadded=!1,template=null;

},{"fs":47,"google-fonts":66,"insert-css":67,"minstache":68,"soundcloud-resolve":69}],66:[function(require,module,exports){
function asString(e){var t=getHref(e);return'<link href="'+t+'" rel="stylesheet" type="text/css">'}function asElement(e){var t=getHref(e),r=document.createElement("link");return r.setAttribute("href",t),r.setAttribute("rel","stylesheet"),r.setAttribute("type","text/css"),r}function getHref(e){var t=Object.keys(e).map(function(t){var r=e[t];return t=t.replace(/\s+/,"+"),"boolean"==typeof r?t:t+":"+makeArray(r).join(",")}).join("|");return"http://fonts.googleapis.com/css?family="+t}function append(e){var t=asElement(e);return document.head.appendChild(t),t}function makeArray(e){return Array.isArray(e)?e:[e]}module.exports=asString,module.exports.add=append;

},{}],67:[function(require,module,exports){
var inserted=[];module.exports=function(e){if(!(inserted.indexOf(e)>=0)){inserted.push(e);var d=document.createElement("style"),t=document.createTextNode(e);d.appendChild(t),document.head.childNodes.length?document.head.insertBefore(d,document.head.childNodes[0]):document.head.appendChild(d)}};

},{}],68:[function(require,module,exports){
function render(e,r){r=r||{};var t=compile(e);return t(r)}function compile(e){for(var r,t=[],n=parse(e),o=0;o<n.length;++o)if(r=n[o],o%2==0)t.push('"'+r.replace(/"/g,'\\"')+'"');else switch(r[0]){case"/":r=r.slice(1),t.push(") + ");break;case"^":r=r.slice(1),assertProperty(r),t.push(' + section(obj, "'+r+'", true, ');break;case"#":r=r.slice(1),assertProperty(r),t.push(' + section(obj, "'+r+'", false, ');break;case"!":r=r.slice(1),assertProperty(r),t.push(" + obj."+r+" + ");break;default:assertProperty(r),t.push(" + escape(obj."+r+") + ")}return t="\n"+indent(escape.toString())+";\n\n"+indent(section.toString())+";\n\n  return "+t.join("").replace(/\n/g,"\\n"),new Function("obj",t)}function assertProperty(e){if(!e.match(/^[\w.]+$/))throw new Error('invalid property "'+e+'"')}function parse(e){return e.split(/\{\{|\}\}/)}function indent(e){return e.replace(/^/gm,"  ")}function section(e,r,t,n){var o=e[r];return"function"==typeof o?o.call(e,n):(t&&(o=!o),o?n:"")}function escape(e){return String(e).replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}exports=module.exports=render,exports.compile=compile;

},{}],69:[function(require,module,exports){
function resolve(r,e,o){var s="http://api.soundcloud.com/resolve.json?"+qs.stringify({url:e,client_id:r});xhr({uri:s,method:"GET"},function(r,e,s){if(r)return o(r);try{s=JSON.parse(s)}catch(r){return o(r)}return s.errors?o(new Error(s.errors[0].error_message)):o(null,s)})}var qs=require("querystring"),xhr=require("xhr");module.exports=resolve;

},{"querystring":64,"xhr":70}],70:[function(require,module,exports){
function createXHR(e,t){function o(){4===s.readyState&&n()}function n(){var e=null,o=s.statusCode=s.status,n=s.body=s.response||s.responseText||s.responseXML;if(0===o||o>=400&&o<600){var r=s.responseText||messages[String(s.status).charAt(0)];e=new Error(r),e.statusCode=s.status}if(c)try{n=s.body=JSON.parse(n)}catch(e){}t(e,s,n)}function r(e){t(e,s)}"string"==typeof e&&(e={uri:e}),e=e||{},t=once(t);var s;s=e.cors?new XDR:new XHR;var a=s.url=e.uri,i=s.method=e.method||"GET",u=e.body||e.data,d=s.headers=e.headers||{},c=!1;return"json"in e&&(c=!0,d["Content-Type"]="application/json",u=JSON.stringify(e.json)),s.onreadystatechange=o,s.onload=n,s.onerror=r,s.onprogress=function(){},s.ontimeout=noop,s.open(i,a),e.cors&&(s.withCredentials=!0),s.timeout="timeout"in e?e.timeout:5e3,s.setRequestHeader&&Object.keys(d).forEach(function(e){s.setRequestHeader(e,d[e])}),s.send(u),s}function noop(){}var window=require("global/window"),once=require("once"),messages={0:"Internal XMLHttpRequest Error",4:"4xx Client Error",5:"5xx Server Error"},XHR=window.XMLHttpRequest||noop,XDR="withCredentials"in new XHR?window.XMLHttpRequest:window.XDomainRequest;module.exports=createXHR;

},{"global/window":71,"once":72}],71:[function(require,module,exports){
(function (global){
"undefined"!=typeof window?module.exports=window:"undefined"!=typeof global?module.exports=global:module.exports={};

}).call(this,typeof global !== "undefined" ? global : typeof self !== "undefined" ? self : typeof window !== "undefined" ? window : {})

},{}],72:[function(require,module,exports){
function once(n){var o=!1;return function(){if(!o)return o=!0,n.apply(this,arguments)}}module.exports=once,once.proto=once(function(){Object.defineProperty(Function.prototype,"once",{value:function(){return once(this)},configurable:!0})});

},{}],73:[function(require,module,exports){
var createTypes=require("./types");module.exports=function(r){var e=createTypes(r);return function(r,t){t=t||{},"string"==typeof t.colors&&(t.colors=[t.colors]);var o=e(r.uniforms,t.colors),s=e(r.attributes,t.colors);for(var a in s)s[a].value=[];return{vertexShader:r.vertex,fragmentShader:r.fragment,uniforms:o,attributes:s}}};

},{"./types":74}],74:[function(require,module,exports){
function create(e){function r(r,t){switch(r){case"float":case"int":return 0;case"vec2":case"ivec2":return new e.Vector2;case"vec3":case"ivec3":return new e.Vector3;case"vec4":case"ivec4":return new e.Vector4;case"mat4":return new e.Matrix4;case"mat3":return new e.Matrix3;case"samplerCube":case"sampler2D":return new e.Texture;default:return}}function t(e,t,n){if(t){"ivec3"===e&&(n*=3);for(var a=new Array(n),c=0;c<a.length;c++)a[c]=r(e,t);return a}return r(e)}function n(e,r){return r?"int"===e?"iv1":"float"===e?"fv1":typeMap[e]+"v":typeMap[e]}return function(r,a){Array.isArray(a)||(a=Array.prototype.slice.call(arguments,1));var c={},o={};r.forEach(function(r){var i=r.name,u=/(.+)\[[0-9]+\]/.exec(i);if(a&&a.indexOf(i)!==-1){if(u)throw new Error("array of color uniforms not supported");if("vec3"!==r.type)throw new Error("ThreeJS expects vec3 for Color uniforms");return void(c[i]={type:"c",value:new e.Color})}u&&(i=u[1],i in o?o[i].count++:o[i]={count:1,type:r.type}),c[i]={type:n(r.type,u),value:u?null:t(r.type)}});for(var i in c){var u=c[i];if(i in o){var v=o[i];u.value=t(v.type,!0,v.count)}}return c}}var typeMap={int:"i",float:"f",ivec2:"i2",ivec3:"i3",ivec4:"i4",vec2:"v2",vec3:"v3",vec4:"v4",mat4:"m4",mat3:"m3",sampler2D:"t",samplerCube:"t"};module.exports=create;

},{}],75:[function(require,module,exports){
(function(){var n=this,t=n._,r=Array.prototype,e=Object.prototype,u=Function.prototype,i=r.push,o=r.slice,a=r.concat,l=e.toString,c=e.hasOwnProperty,f=Array.isArray,s=Object.keys,p=u.bind,h=function(n){return n instanceof h?n:this instanceof h?void(this._wrapped=n):new h(n)};"undefined"!=typeof exports?("undefined"!=typeof module&&module.exports&&(exports=module.exports=h),exports._=h):n._=h,h.VERSION="1.7.0";var v=function(n,t,r){if(void 0===t)return n;switch(null==r?3:r){case 1:return function(r){return n.call(t,r)};case 2:return function(r,e){return n.call(t,r,e)};case 3:return function(r,e,u){return n.call(t,r,e,u)};case 4:return function(r,e,u,i){return n.call(t,r,e,u,i)}}return function(){return n.apply(t,arguments)}};h.iteratee=function(n,t,r){return null==n?h.identity:h.isFunction(n)?v(n,t,r):h.isObject(n)?h.matches(n):h.property(n)},h.each=h.forEach=function(n,t,r){if(null==n)return n;t=v(t,r);var e,u=n.length;if(u===+u)for(e=0;e<u;e++)t(n[e],e,n);else{var i=h.keys(n);for(e=0,u=i.length;e<u;e++)t(n[i[e]],i[e],n)}return n},h.map=h.collect=function(n,t,r){if(null==n)return[];t=h.iteratee(t,r);for(var e,u=n.length!==+n.length&&h.keys(n),i=(u||n).length,o=Array(i),a=0;a<i;a++)e=u?u[a]:a,o[a]=t(n[e],e,n);return o};var g="Reduce of empty array with no initial value";h.reduce=h.foldl=h.inject=function(n,t,r,e){null==n&&(n=[]),t=v(t,e,4);var u,i=n.length!==+n.length&&h.keys(n),o=(i||n).length,a=0;if(arguments.length<3){if(!o)throw new TypeError(g);r=n[i?i[a++]:a++]}for(;a<o;a++)u=i?i[a]:a,r=t(r,n[u],u,n);return r},h.reduceRight=h.foldr=function(n,t,r,e){null==n&&(n=[]),t=v(t,e,4);var u,i=n.length!==+n.length&&h.keys(n),o=(i||n).length;if(arguments.length<3){if(!o)throw new TypeError(g);r=n[i?i[--o]:--o]}for(;o--;)u=i?i[o]:o,r=t(r,n[u],u,n);return r},h.find=h.detect=function(n,t,r){var e;return t=h.iteratee(t,r),h.some(n,function(n,r,u){if(t(n,r,u))return e=n,!0}),e},h.filter=h.select=function(n,t,r){var e=[];return null==n?e:(t=h.iteratee(t,r),h.each(n,function(n,r,u){t(n,r,u)&&e.push(n)}),e)},h.reject=function(n,t,r){return h.filter(n,h.negate(h.iteratee(t)),r)},h.every=h.all=function(n,t,r){if(null==n)return!0;t=h.iteratee(t,r);var e,u,i=n.length!==+n.length&&h.keys(n),o=(i||n).length;for(e=0;e<o;e++)if(u=i?i[e]:e,!t(n[u],u,n))return!1;return!0},h.some=h.any=function(n,t,r){if(null==n)return!1;t=h.iteratee(t,r);var e,u,i=n.length!==+n.length&&h.keys(n),o=(i||n).length;for(e=0;e<o;e++)if(u=i?i[e]:e,t(n[u],u,n))return!0;return!1},h.contains=h.include=function(n,t){return null!=n&&(n.length!==+n.length&&(n=h.values(n)),h.indexOf(n,t)>=0)},h.invoke=function(n,t){var r=o.call(arguments,2),e=h.isFunction(t);return h.map(n,function(n){return(e?t:n[t]).apply(n,r)})},h.pluck=function(n,t){return h.map(n,h.property(t))},h.where=function(n,t){return h.filter(n,h.matches(t))},h.findWhere=function(n,t){return h.find(n,h.matches(t))},h.max=function(n,t,r){var e,u,i=-(1/0),o=-(1/0);if(null==t&&null!=n){n=n.length===+n.length?n:h.values(n);for(var a=0,l=n.length;a<l;a++)e=n[a],e>i&&(i=e)}else t=h.iteratee(t,r),h.each(n,function(n,r,e){u=t(n,r,e),(u>o||u===-(1/0)&&i===-(1/0))&&(i=n,o=u)});return i},h.min=function(n,t,r){var e,u,i=1/0,o=1/0;if(null==t&&null!=n){n=n.length===+n.length?n:h.values(n);for(var a=0,l=n.length;a<l;a++)e=n[a],e<i&&(i=e)}else t=h.iteratee(t,r),h.each(n,function(n,r,e){u=t(n,r,e),(u<o||u===1/0&&i===1/0)&&(i=n,o=u)});return i},h.shuffle=function(n){for(var t,r=n&&n.length===+n.length?n:h.values(n),e=r.length,u=Array(e),i=0;i<e;i++)t=h.random(0,i),t!==i&&(u[i]=u[t]),u[t]=r[i];return u},h.sample=function(n,t,r){return null==t||r?(n.length!==+n.length&&(n=h.values(n)),n[h.random(n.length-1)]):h.shuffle(n).slice(0,Math.max(0,t))},h.sortBy=function(n,t,r){return t=h.iteratee(t,r),h.pluck(h.map(n,function(n,r,e){return{value:n,index:r,criteria:t(n,r,e)}}).sort(function(n,t){var r=n.criteria,e=t.criteria;if(r!==e){if(r>e||void 0===r)return 1;if(r<e||void 0===e)return-1}return n.index-t.index}),"value")};var y=function(n){return function(t,r,e){var u={};return r=h.iteratee(r,e),h.each(t,function(e,i){var o=r(e,i,t);n(u,e,o)}),u}};h.groupBy=y(function(n,t,r){h.has(n,r)?n[r].push(t):n[r]=[t]}),h.indexBy=y(function(n,t,r){n[r]=t}),h.countBy=y(function(n,t,r){h.has(n,r)?n[r]++:n[r]=1}),h.sortedIndex=function(n,t,r,e){r=h.iteratee(r,e,1);for(var u=r(t),i=0,o=n.length;i<o;){var a=i+o>>>1;r(n[a])<u?i=a+1:o=a}return i},h.toArray=function(n){return n?h.isArray(n)?o.call(n):n.length===+n.length?h.map(n,h.identity):h.values(n):[]},h.size=function(n){return null==n?0:n.length===+n.length?n.length:h.keys(n).length},h.partition=function(n,t,r){t=h.iteratee(t,r);var e=[],u=[];return h.each(n,function(n,r,i){(t(n,r,i)?e:u).push(n)}),[e,u]},h.first=h.head=h.take=function(n,t,r){if(null!=n)return null==t||r?n[0]:t<0?[]:o.call(n,0,t)},h.initial=function(n,t,r){return o.call(n,0,Math.max(0,n.length-(null==t||r?1:t)))},h.last=function(n,t,r){if(null!=n)return null==t||r?n[n.length-1]:o.call(n,Math.max(n.length-t,0))},h.rest=h.tail=h.drop=function(n,t,r){return o.call(n,null==t||r?1:t)},h.compact=function(n){return h.filter(n,h.identity)};var d=function(n,t,r,e){if(t&&h.every(n,h.isArray))return a.apply(e,n);for(var u=0,o=n.length;u<o;u++){var l=n[u];h.isArray(l)||h.isArguments(l)?t?i.apply(e,l):d(l,t,r,e):r||e.push(l)}return e};h.flatten=function(n,t){return d(n,t,!1,[])},h.without=function(n){return h.difference(n,o.call(arguments,1))},h.uniq=h.unique=function(n,t,r,e){if(null==n)return[];h.isBoolean(t)||(e=r,r=t,t=!1),null!=r&&(r=h.iteratee(r,e));for(var u=[],i=[],o=0,a=n.length;o<a;o++){var l=n[o];if(t)o&&i===l||u.push(l),i=l;else if(r){var c=r(l,o,n);h.indexOf(i,c)<0&&(i.push(c),u.push(l))}else h.indexOf(u,l)<0&&u.push(l)}return u},h.union=function(){return h.uniq(d(arguments,!0,!0,[]))},h.intersection=function(n){if(null==n)return[];for(var t=[],r=arguments.length,e=0,u=n.length;e<u;e++){var i=n[e];if(!h.contains(t,i)){for(var o=1;o<r&&h.contains(arguments[o],i);o++);o===r&&t.push(i)}}return t},h.difference=function(n){var t=d(o.call(arguments,1),!0,!0,[]);return h.filter(n,function(n){return!h.contains(t,n)})},h.zip=function(n){if(null==n)return[];for(var t=h.max(arguments,"length").length,r=Array(t),e=0;e<t;e++)r[e]=h.pluck(arguments,e);return r},h.object=function(n,t){if(null==n)return{};for(var r={},e=0,u=n.length;e<u;e++)t?r[n[e]]=t[e]:r[n[e][0]]=n[e][1];return r},h.indexOf=function(n,t,r){if(null==n)return-1;var e=0,u=n.length;if(r){if("number"!=typeof r)return e=h.sortedIndex(n,t),n[e]===t?e:-1;e=r<0?Math.max(0,u+r):r}for(;e<u;e++)if(n[e]===t)return e;return-1},h.lastIndexOf=function(n,t,r){if(null==n)return-1;var e=n.length;for("number"==typeof r&&(e=r<0?e+r+1:Math.min(e,r+1));--e>=0;)if(n[e]===t)return e;return-1},h.range=function(n,t,r){arguments.length<=1&&(t=n||0,n=0),r=r||1;for(var e=Math.max(Math.ceil((t-n)/r),0),u=Array(e),i=0;i<e;i++,n+=r)u[i]=n;return u};var m=function(){};h.bind=function(n,t){var r,e;if(p&&n.bind===p)return p.apply(n,o.call(arguments,1));if(!h.isFunction(n))throw new TypeError("Bind must be called on a function");return r=o.call(arguments,2),e=function(){if(!(this instanceof e))return n.apply(t,r.concat(o.call(arguments)));m.prototype=n.prototype;var u=new m;m.prototype=null;var i=n.apply(u,r.concat(o.call(arguments)));return h.isObject(i)?i:u}},h.partial=function(n){var t=o.call(arguments,1);return function(){for(var r=0,e=t.slice(),u=0,i=e.length;u<i;u++)e[u]===h&&(e[u]=arguments[r++]);for(;r<arguments.length;)e.push(arguments[r++]);return n.apply(this,e)}},h.bindAll=function(n){var t,r,e=arguments.length;if(e<=1)throw new Error("bindAll must be passed function names");for(t=1;t<e;t++)r=arguments[t],n[r]=h.bind(n[r],n);return n},h.memoize=function(n,t){var r=function(e){var u=r.cache,i=t?t.apply(this,arguments):e;return h.has(u,i)||(u[i]=n.apply(this,arguments)),u[i]};return r.cache={},r},h.delay=function(n,t){var r=o.call(arguments,2);return setTimeout(function(){return n.apply(null,r)},t)},h.defer=function(n){return h.delay.apply(h,[n,1].concat(o.call(arguments,1)))},h.throttle=function(n,t,r){var e,u,i,o=null,a=0;r||(r={});var l=function(){a=r.leading===!1?0:h.now(),o=null,i=n.apply(e,u),o||(e=u=null)};return function(){var c=h.now();a||r.leading!==!1||(a=c);var f=t-(c-a);return e=this,u=arguments,f<=0||f>t?(clearTimeout(o),o=null,a=c,i=n.apply(e,u),o||(e=u=null)):o||r.trailing===!1||(o=setTimeout(l,f)),i}},h.debounce=function(n,t,r){var e,u,i,o,a,l=function(){var c=h.now()-o;c<t&&c>0?e=setTimeout(l,t-c):(e=null,r||(a=n.apply(i,u),e||(i=u=null)))};return function(){i=this,u=arguments,o=h.now();var c=r&&!e;return e||(e=setTimeout(l,t)),c&&(a=n.apply(i,u),i=u=null),a}},h.wrap=function(n,t){return h.partial(t,n)},h.negate=function(n){return function(){return!n.apply(this,arguments)}},h.compose=function(){var n=arguments,t=n.length-1;return function(){for(var r=t,e=n[t].apply(this,arguments);r--;)e=n[r].call(this,e);return e}},h.after=function(n,t){return function(){if(--n<1)return t.apply(this,arguments)}},h.before=function(n,t){var r;return function(){return--n>0?r=t.apply(this,arguments):t=null,r}},h.once=h.partial(h.before,2),h.keys=function(n){if(!h.isObject(n))return[];if(s)return s(n);var t=[];for(var r in n)h.has(n,r)&&t.push(r);return t},h.values=function(n){for(var t=h.keys(n),r=t.length,e=Array(r),u=0;u<r;u++)e[u]=n[t[u]];return e},h.pairs=function(n){for(var t=h.keys(n),r=t.length,e=Array(r),u=0;u<r;u++)e[u]=[t[u],n[t[u]]];return e},h.invert=function(n){for(var t={},r=h.keys(n),e=0,u=r.length;e<u;e++)t[n[r[e]]]=r[e];return t},h.functions=h.methods=function(n){var t=[];for(var r in n)h.isFunction(n[r])&&t.push(r);return t.sort()},h.extend=function(n){if(!h.isObject(n))return n;for(var t,r,e=1,u=arguments.length;e<u;e++){t=arguments[e];for(r in t)c.call(t,r)&&(n[r]=t[r])}return n},h.pick=function(n,t,r){var e,u={};if(null==n)return u;if(h.isFunction(t)){t=v(t,r);for(e in n){var i=n[e];t(i,e,n)&&(u[e]=i)}}else{var l=a.apply([],o.call(arguments,1));n=new Object(n);for(var c=0,f=l.length;c<f;c++)e=l[c],e in n&&(u[e]=n[e])}return u},h.omit=function(n,t,r){if(h.isFunction(t))t=h.negate(t);else{var e=h.map(a.apply([],o.call(arguments,1)),String);t=function(n,t){return!h.contains(e,t)}}return h.pick(n,t,r)},h.defaults=function(n){if(!h.isObject(n))return n;for(var t=1,r=arguments.length;t<r;t++){var e=arguments[t];for(var u in e)void 0===n[u]&&(n[u]=e[u])}return n},h.clone=function(n){return h.isObject(n)?h.isArray(n)?n.slice():h.extend({},n):n},h.tap=function(n,t){return t(n),n};var b=function(n,t,r,e){if(n===t)return 0!==n||1/n===1/t;if(null==n||null==t)return n===t;n instanceof h&&(n=n._wrapped),t instanceof h&&(t=t._wrapped);var u=l.call(n);if(u!==l.call(t))return!1;switch(u){case"[object RegExp]":case"[object String]":return""+n==""+t;case"[object Number]":return+n!==+n?+t!==+t:0===+n?1/+n===1/t:+n===+t;case"[object Date]":case"[object Boolean]":return+n===+t}if("object"!=typeof n||"object"!=typeof t)return!1;for(var i=r.length;i--;)if(r[i]===n)return e[i]===t;var o=n.constructor,a=t.constructor;if(o!==a&&"constructor"in n&&"constructor"in t&&!(h.isFunction(o)&&o instanceof o&&h.isFunction(a)&&a instanceof a))return!1;r.push(n),e.push(t);var c,f;if("[object Array]"===u){if(c=n.length,f=c===t.length)for(;c--&&(f=b(n[c],t[c],r,e)););}else{var s,p=h.keys(n);if(c=p.length,f=h.keys(t).length===c)for(;c--&&(s=p[c],f=h.has(t,s)&&b(n[s],t[s],r,e)););}return r.pop(),e.pop(),f};h.isEqual=function(n,t){return b(n,t,[],[])},h.isEmpty=function(n){if(null==n)return!0;if(h.isArray(n)||h.isString(n)||h.isArguments(n))return 0===n.length;for(var t in n)if(h.has(n,t))return!1;return!0},h.isElement=function(n){return!(!n||1!==n.nodeType)},h.isArray=f||function(n){return"[object Array]"===l.call(n)},h.isObject=function(n){var t=typeof n;return"function"===t||"object"===t&&!!n},h.each(["Arguments","Function","String","Number","Date","RegExp"],function(n){h["is"+n]=function(t){return l.call(t)==="[object "+n+"]"}}),h.isArguments(arguments)||(h.isArguments=function(n){return h.has(n,"callee")}),"function"!=typeof/./&&(h.isFunction=function(n){return"function"==typeof n||!1}),h.isFinite=function(n){return isFinite(n)&&!isNaN(parseFloat(n))},h.isNaN=function(n){return h.isNumber(n)&&n!==+n},h.isBoolean=function(n){return n===!0||n===!1||"[object Boolean]"===l.call(n)},h.isNull=function(n){return null===n},h.isUndefined=function(n){return void 0===n},h.has=function(n,t){return null!=n&&c.call(n,t)},h.noConflict=function(){return n._=t,this},h.identity=function(n){return n},h.constant=function(n){return function(){return n}},h.noop=function(){},h.property=function(n){return function(t){return t[n]}},h.matches=function(n){var t=h.pairs(n),r=t.length;return function(n){if(null==n)return!r;n=new Object(n);for(var e=0;e<r;e++){var u=t[e],i=u[0];if(u[1]!==n[i]||!(i in n))return!1}return!0}},h.times=function(n,t,r){var e=Array(Math.max(0,n));t=v(t,r,1);for(var u=0;u<n;u++)e[u]=t(u);return e},h.random=function(n,t){return null==t&&(t=n,n=0),n+Math.floor(Math.random()*(t-n+1))},h.now=Date.now||function(){return(new Date).getTime()};var _={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;"},w=h.invert(_),j=function(n){var t=function(t){return n[t]},r="(?:"+h.keys(n).join("|")+")",e=RegExp(r),u=RegExp(r,"g");return function(n){return n=null==n?"":""+n,e.test(n)?n.replace(u,t):n}};h.escape=j(_),h.unescape=j(w),h.result=function(n,t){if(null!=n){var r=n[t];return h.isFunction(r)?n[t]():r}};var x=0;h.uniqueId=function(n){var t=++x+"";return n?n+t:t},h.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var A=/(.)^/,k={"'":"'","\\":"\\","\r":"r","\n":"n","\u2028":"u2028","\u2029":"u2029"},O=/\\|'|\r|\n|\u2028|\u2029/g,F=function(n){return"\\"+k[n]};h.template=function(n,t,r){!t&&r&&(t=r),t=h.defaults({},t,h.templateSettings);var e=RegExp([(t.escape||A).source,(t.interpolate||A).source,(t.evaluate||A).source].join("|")+"|$","g"),u=0,i="__p+='";n.replace(e,function(t,r,e,o,a){return i+=n.slice(u,a).replace(O,F),u=a+t.length,r?i+="'+\n((__t=("+r+"))==null?'':_.escape(__t))+\n'":e?i+="'+\n((__t=("+e+"))==null?'':__t)+\n'":o&&(i+="';\n"+o+"\n__p+='"),t}),i+="';\n",t.variable||(i="with(obj||{}){\n"+i+"}\n"),i="var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\n"+i+"return __p;\n";try{var o=new Function(t.variable||"obj","_",i)}catch(n){throw n.source=i,n}var a=function(n){return o.call(this,n,h)},l=t.variable||"obj";return a.source="function("+l+"){\n"+i+"}",a},h.chain=function(n){var t=h(n);return t._chain=!0,t};var E=function(n){return this._chain?h(n).chain():n};h.mixin=function(n){h.each(h.functions(n),function(t){var r=h[t]=n[t];h.prototype[t]=function(){var n=[this._wrapped];return i.apply(n,arguments),E.call(this,r.apply(h,n))}})},h.mixin(h),h.each(["pop","push","reverse","shift","sort","splice","unshift"],function(n){var t=r[n];h.prototype[n]=function(){var r=this._wrapped;return t.apply(r,arguments),"shift"!==n&&"splice"!==n||0!==r.length||delete r[0],E.call(this,r)}}),h.each(["concat","join","slice"],function(n){var t=r[n];h.prototype[n]=function(){return E.call(this,t.apply(this._wrapped,arguments))}}),h.prototype.value=function(){return this._wrapped},"function"==typeof define&&define.amd&&define("underscore",[],function(){return h})}).call(this);

},{}]},{},[46])
//# sourceMappingURL=bundle.js.map
